openapi: 3.1.0
info:
  contact:
    email: support@whisper.security
    name: Whisper Security Support
    url: https://whisper.security/support
  description: |
    # Whisper Security Threat Intelligence API

    The Whisper Security API provides comprehensive threat intelligence, geolocation data,
    and security operations capabilities for enterprise security teams and developers.

    ## Key Capabilities

    - **Indicator Enrichment**: Get comprehensive intelligence on IP addresses and domains including
      geolocation, WHOIS, DNS, reputation scoring, and relationship mapping.
    - **Geolocation Services**: Fast IP-to-location lookups with ISP, ASN, and network information.
    - **Security Operations**: Asynchronous tools for bulk enrichment, infrastructure scanning,
      AI-powered threat investigation, and monitoring.

    ## API Design

    - **RESTful**: Standard HTTP methods (GET, POST, PUT, DELETE) with JSON request/response bodies.
    - **Synchronous Endpoints**: Fast responses (<500ms) for indicator enrichment and geolocation.
    - **Asynchronous Jobs**: Long-running operations return a job ID for polling results.
    - **Consistent Error Handling**: Standardized error responses with status codes, error codes, and messages.

    ## Authentication

    All API endpoints require Bearer token authentication. Include your API key in the
    `Authorization` header: `Authorization: Bearer <your-api-key>`

    ## Rate Limits

    Rate limits are applied per-user and vary by endpoint category:

    | Endpoint Category | Rate Limit | Description |
    |-------------------|------------|-------------|
    | Indicators (`/v1/indicators/*`) | 100 req/sec | Single indicator enrichment |
    | Location (`/v1/location/*`) | 100 req/sec | Geolocation lookups |
    | Jobs (`/v1/ops/jobs/*`) | 100 req/sec | Job status and listing |
    | Bulk Operations (`/v1/ops/enrichment/bulk`) | 10 req/sec | Bulk indicator processing |
    | Screenshots (`/v1/ops/screenshots/*`) | 10 req/sec | Screenshot capture and scheduling |
    | Scans (`/v1/ops/scans/*`) | 10 req/sec | Infrastructure scanning |
    | Monitoring (`/v1/ops/monitoring/*`) | 10 req/sec | Uptime monitoring |
    | Tracking (`/v1/ops/tracking/*`) | 10 req/sec | Change tracking |
    | AI Investigate (`/v1/ops/ai/investigate`) | 5 req/min | Deep threat investigation |
    | AI Correlate (`/v1/ops/ai/correlate`) | 5 req/min | Global correlation |
    | AI Attribute (`/v1/ops/ai/attribute`) | 5 req/min | Threat actor attribution |
    | AI Pivot (`/v1/ops/ai/pivot`) | 5 req/min | Infrastructure pivoting |

    When rate limits are exceeded, the API returns HTTP `429 Too Many Requests` with a
    `Retry-After` header indicating when you can retry. The response body includes:
    ```json
    {
      "error": "Too Many Requests",
      "message": "Rate limit exceeded for <category>. Please retry after N seconds.",
      "retryAfter": N
    }
    ```

    ## Response Conventions

    - All timestamps are in ISO 8601 format (UTC).
    - Pagination uses `limit` and `offset` parameters.
    - Field names use camelCase throughout the API.

    ## Official SDKs

    - **Python**: [github.com/whisper-sec/sdk-python](https://github.com/whisper-sec/sdk-python)
    - **TypeScript/JavaScript**: [github.com/whisper-sec/sdk-typescript](https://github.com/whisper-sec/sdk-typescript)
    - **Java**: [github.com/whisper-sec/sdk-java](https://github.com/whisper-sec/sdk-java)
    - **C#/.NET**: [github.com/whisper-sec/sdk-csharp](https://github.com/whisper-sec/sdk-csharp)

    ## Resources

    - **Website**: [whisper.security](https://whisper.security)
    - **Dashboard**: [dash.whisper.security](https://dash.whisper.security) - Manage API keys and view usage
    - **Documentation**: [docs.whisper.security](https://docs.whisper.security) - Guides and tutorials
  license:
    name: Proprietary
    url: https://whisper.security/license
  termsOfService: https://whisper.security/terms
  title: Whisper Security API
  version: 1.0.0
externalDocs:
  description: Whisper Security API Documentation & Guides
  url: https://docs.whisper.security
servers:
- description: Production API Server
  url: https://api.whisper.security
- description: Staging API Server (for testing)
  url: https://api-staging.whisper.security
- description: Local Development Server
  url: http://localhost:8080
security:
- bearerAuth: []
tags:
- description: |
    **Website Screenshot Capture**

    Capture screenshots of websites for visual analysis, brand monitoring,
    and phishing detection. Supports one-time captures and scheduled recurring captures.

    **Features:**
    - Full page or viewport capture
    - PNG/JPEG format support
    - Scheduled recurring captures
    - Screenshot history and change detection

    **Rate Limit:** 10 req/sec
  name: Screenshots
- description: |
    **IP and Domain Enrichment**

    Comprehensive threat intelligence enrichment for IP addresses and domains.
    Includes both synchronous single-indicator lookups and asynchronous bulk operations.

    **Synchronous (single indicator):**
    High-performance lookups typically completing in under 500ms.
    - Single IP/domain enrichment with geolocation, WHOIS, DNS, reputation
    - Historical data and relationship graphs
    - AI-powered predictive risk scoring

    **Asynchronous (bulk):**
    Process up to 100 indicators per request. Returns a job ID for polling results.
    - Bulk indicator enrichment
    - WHOIS field-based search (registrant name, email, organization)
    - Typosquatting and lookalike domain detection

    **Data Sources:**
    Geolocation, WHOIS registration, DNS records, reputation scoring, BGP routing,
    RPKI validation, SSL certificates, and relationship graphs.

    **Rate Limits:** Sync: 100 req/sec | Bulk: 10 req/sec
  name: Enrichment
- description: |
    **Fast Geolocation and Network Lookups**

    Ultra-fast IP geolocation with ISP, ASN, and network classification data.
    Optimized for real-time fraud detection and access control use cases.

    **Performance:**
    Single IP lookups typically respond in <150ms with 6-hour caching.

    **Rate Limit:** 100 req/sec
  name: Location
- description: |
    **Asynchronous Job Management**

    Manage and monitor long-running asynchronous operations. All async endpoints return
    a job ID that can be used to poll for status and retrieve results.

    **Job Lifecycle:**
    - PENDING: Job is queued for processing
    - PROCESSING: Job is currently being executed
    - COMPLETED: Job finished successfully, results available
    - FAILED: Job encountered an error

    **Retention:**
    Job results are retained for 24 hours after completion.

    **Rate Limit:** 100 req/sec
  name: Jobs
- description: |
    **Uptime and Availability Monitoring**

    Configure monitoring checks for websites, APIs, and infrastructure endpoints.
    Receive alerts when targets become unavailable or experience issues.

    **Check Types:**
    - HTTP/HTTPS endpoint monitoring
    - Response time tracking
    - SSL certificate expiration alerts
    - Custom threshold configuration

    **Rate Limit:** 10 req/sec
  name: Monitoring
- description: |
    Direct access to the Whisper graph database via Cypher and GraphQL queries.

    **Use Cases:**
    - Advanced threat hunting with custom graph queries
    - Exploring relationships between indicators
    - Building custom visualizations and reports

    **Available Node Types:**
    `DomainName`, `A_ADDRESS`, `AAAA_ADDRESS`, `ASN`, `TLD`, `ANNOUNCED_PREFIX_4`,
    `ANNOUNCED_PREFIX_6`, `Organisation`, `Country`, `LIST`, `LISTCATEGORY`, `TLSCA`, `TLSCert`

    **Available Relationships:**
    `hasIP`, `hasIPv6`, `hasNameserver`, `hasMailHost`, `hasTLD`, `announces`,
    `inASN`, `isListed`, `hasCA`, `isIssuer`, `isSubjectOf`
  name: Graph Database
- description: |
    **AI-Powered Threat Intelligence**

    Advanced machine learning and LLM-powered analysis for threat investigation,
    attribution, and correlation. These operations are computationally intensive
    and return a job ID for polling results.

    **Capabilities:**
    - Deep threat investigation with verdict and recommendations
    - Similar historical case matching
    - Infrastructure pivoting and relationship discovery
    - Threat actor attribution and TTP mapping
    - Global indicator correlation across customers
    - Industry security benchmarks (synchronous)

    **Performance:**
    Most AI operations complete in 30 seconds to 5 minutes depending on complexity.

    **Rate Limit:** 5 requests per minute for async AI operations.
  name: AI Intelligence
- description: |
    **Indicator Change Detection**

    Track changes to indicators over time. Monitor WHOIS records, DNS configurations,
    SSL certificates, and other attributes for modifications.

    **Features:**
    - Automatic periodic checks
    - Manual on-demand checks
    - Change history with diff details
    - Configurable tracking parameters

    **Rate Limit:** 10 req/sec
  name: Change Tracking
- description: |
    **Infrastructure Discovery and Security Scanning**

    Asynchronous scanning operations for discovering and analyzing infrastructure.
    Returns a job ID for polling results.

    **Scan Types:**
    - SSL certificate analysis and chain validation
    - Technology stack detection
    - Subdomain enumeration
    - Port scanning
    - Infrastructure relationship mapping

    **Rate Limit:** 10 req/sec
  name: Infrastructure Scanning
paths:
  /v1/ops/monitoring/{checkId}:
    delete:
      description: Delete a monitoring check and stop all monitoring for the target.
      operationId: deleteMonitorCheck
      parameters:
      - description: Check ID
        example: abc123
        explode: false
        in: path
        name: checkId
        required: true
        schema:
          type: string
        style: simple
      responses:
        "204":
          content:
            '*/*':
              schema:
                type: object
          description: Check deleted successfully.
        "404":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Check not found or access denied.
        "401":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Authentication failed.
      security:
      - bearerAuth: []
      summary: Delete Monitoring Check
      tags:
      - Monitoring
      x-accepts:
      - '*/*'
      - application/json
    get:
      description: Get details of a specific monitoring check including uptime metrics.
      operationId: getMonitorCheck
      parameters:
      - description: Check ID
        example: abc123
        explode: false
        in: path
        name: checkId
        required: true
        schema:
          type: string
        style: simple
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/MonitorCheckResponse"
          description: Check details.
        "404":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Check not found or access denied.
        "401":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Authentication failed.
      security:
      - bearerAuth: []
      summary: Get Monitoring Check
      tags:
      - Monitoring
      x-accepts:
      - application/json
    put:
      description: Update an existing monitoring check configuration.
      operationId: updateMonitorCheck
      parameters:
      - description: Check ID
        example: abc123
        explode: false
        in: path
        name: checkId
        required: true
        schema:
          type: string
        style: simple
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/MonitorCheckRequest"
        description: Updated check configuration
        required: true
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/MonitorCheckResponse"
          description: Check updated successfully.
        "404":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Check not found or access denied.
        "401":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Authentication failed.
      security:
      - bearerAuth: []
      summary: Update Monitoring Check
      tags:
      - Monitoring
      x-content-type: application/json
      x-accepts:
      - application/json
  /v1/ops/tracking/{type}/{value}:
    delete:
      description: |
        <p>Stop tracking changes for an indicator. Optionally delete all change history.</p>
      operationId: stopChangeTracking
      parameters:
      - description: "Indicator type: ip or domain"
        explode: false
        in: path
        name: type
        required: true
        schema:
          type: string
        style: simple
      - description: Indicator value
        explode: false
        in: path
        name: value
        required: true
        schema:
          type: string
        style: simple
      - description: Delete change history as well
        explode: true
        in: query
        name: deleteHistory
        required: false
        schema:
          default: false
          type: boolean
        style: form
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/GenericSuccessResponse"
          description: Tracking stopped successfully.
        "401":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Authentication failed.
        "500":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Internal server error.
      security:
      - bearerAuth: []
      summary: Stop Change Tracking
      tags:
      - Change Tracking
      x-accepts:
      - application/json
    get:
      description: |
        <p>Retrieve detected changes for a tracked indicator. Returns the current tracking configuration,
        baseline snapshot, and list of all detected changes.</p>
        <h4>Response Includes:</h4>
        <ul>
            <li><b>tracking:</b> Current tracking configuration (enabled, frequency, fields, next check)</li>
            <li><b>baseline:</b> The stored baseline snapshot data</li>
            <li><b>changes:</b> Array of detected changes with timestamps, old/new values</li>
            <li><b>totalChanges:</b> Total number of changes detected</li>
        </ul>
      operationId: getChanges
      parameters:
      - description: "Indicator type: ip or domain"
        example: domain
        explode: false
        in: path
        name: type
        required: true
        schema:
          type: string
        style: simple
      - description: Indicator value
        example: google.com
        explode: false
        in: path
        name: value
        required: true
        schema:
          type: string
        style: simple
      - description: ISO 8601 timestamp to get changes from
        example: 2025-01-01T00:00:00Z
        explode: true
        in: query
        name: since
        required: false
        schema:
          type: string
        style: form
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ChangeTrackingResponse"
          description: Successfully retrieved changes.
        "404":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Indicator is not being tracked.
        "401":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Authentication failed.
      security:
      - bearerAuth: []
      summary: Get Detected Changes
      tags:
      - Change Tracking
      x-accepts:
      - application/json
    post:
      description: |
        <p>Start tracking changes for an IP or domain. When tracking is started, a baseline snapshot is captured.
        Subsequent checks will compare against this baseline and record any detected changes.</p>
        <h4>Trackable Fields for Domains:</h4>
        <ul>
            <li><b>dns:</b> A, AAAA, MX, NS, TXT, CNAME records</li>
            <li><b>whois:</b> Registrant, registrar, dates, nameservers</li>
            <li><b>ssl:</b> Certificate issuer, expiry, SAN</li>
            <li><b>subdomains:</b> Discovered subdomains</li>
            <li><b>ips:</b> Resolved IP addresses</li>
        </ul>
        <h4>Trackable Fields for IPs:</h4>
        <ul>
            <li><b>geolocation:</b> Country, city, coordinates</li>
            <li><b>asn:</b> ASN number, organization</li>
            <li><b>routing:</b> BGP routing status</li>
            <li><b>rpki:</b> RPKI validation status</li>
            <li><b>reverse_dns:</b> PTR records</li>
        </ul>
        <h4>Frequencies:</h4>
        <ul>
            <li><b>hourly:</b> Check every hour</li>
            <li><b>daily:</b> Check once per day (default)</li>
            <li><b>weekly:</b> Check once per week</li>
        </ul>
      operationId: startChangeTracking
      parameters:
      - description: "Indicator type: ip or domain"
        example: domain
        explode: false
        in: path
        name: type
        required: true
        schema:
          type: string
        style: simple
      - description: Indicator value (IP address or domain name)
        example: google.com
        explode: false
        in: path
        name: value
        required: true
        schema:
          type: string
        style: simple
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ChangeTrackingRequest"
        description: Tracking configuration
        required: true
      responses:
        "202":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/JobResponse"
          description: Tracking started. Job ID returned for baseline capture.
        "400":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Invalid indicator type or fields.
        "401":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Authentication failed.
      security:
      - bearerAuth: []
      summary: Start Change Tracking
      tags:
      - Change Tracking
      x-content-type: application/json
      x-accepts:
      - application/json
  /v1/ops/tracking/{type}/{value}/check:
    post:
      description: |
        <p>Trigger an immediate check for changes on a tracked indicator. Creates a job to compare
        current data against the stored baseline.</p>
      operationId: triggerCheck
      parameters:
      - description: Indicator type
        example: domain
        explode: false
        in: path
        name: type
        required: true
        schema:
          type: string
        style: simple
      - description: Indicator value
        example: google.com
        explode: false
        in: path
        name: value
        required: true
        schema:
          type: string
        style: simple
      responses:
        "202":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/GenericSuccessResponse"
          description: Check triggered successfully.
        "400":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Invalid indicator type.
        "404":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Indicator is not being tracked.
        "401":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Authentication failed.
      security:
      - bearerAuth: []
      summary: Trigger Immediate Check
      tags:
      - Change Tracking
      x-accepts:
      - application/json
  /v1/ops/screenshots/schedule:
    post:
      description: |
        <p>Create a recurring job to capture website screenshots at regular intervals. Essential for monitoring website changes, detecting defacements, and tracking competitor updates.</p>
        <h4>Schedule Options:</h4>
        <ul>
            <li><b>Cron Expression:</b> Full cron syntax support (e.g., `0 0 * * * *` = hourly)</li>
            <li><b>Frequency Presets:</b> hourly, every_6_hours, every_12_hours, twice_daily, daily, weekly, monthly</li>
            <li><b>Timezone:</b> Specify timezone for accurate scheduling (default: UTC)</li>
        </ul>
        <h4>First Screenshot:</h4>
        <p>The <b>first screenshot is captured immediately</b> when a schedule is created. Subsequent screenshots follow the configured schedule. This ensures you have baseline data right away.</p>
        <h4>Limits:</h4>
        <ul>
            <li><b>Max Schedules:</b> 3 per API key</li>
            <li><b>Max Screenshots:</b> 50 retained per schedule (oldest deleted automatically)</li>
            <li><b>Schedule Expiration:</b> Schedules auto-expire after 90 days of inactivity</li>
            <li><b>Screenshot Retention:</b> Individual screenshots expire after 14 days</li>
        </ul>
        <h4>Performance:</h4>
        <ul>
            <li><b>Setup Time:</b> ~2 seconds to create schedule</li>
            <li><b>First Screenshot:</b> Triggered immediately on schedule creation</li>
            <li><b>Screenshot Time:</b> 10-30 seconds per capture</li>
        </ul>
        <h4>Use Cases:</h4>
        <ul>
            <li>Automated defacement detection</li>
            <li>Compliance monitoring and archival</li>
            <li>Competitor website tracking</li>
            <li>Visual regression testing</li>
        </ul>
        <h4>Management:</h4>
        <p>Use <code>GET /v1/ops/screenshots/schedules</code> to list schedules, <code>DELETE /v1/ops/screenshots/schedules/{id}</code> to delete.</p>
      operationId: scheduleScreenshot
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ScreenshotRequest"
        description: "Schedule configuration including URL, schedule timing, and screenshot\
          \ options."
        required: true
      responses:
        "202":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/JobResponse"
          description: "Schedule successfully created. Poll `/v1/ops/jobs/{jobId}`\
            \ for status."
        "400":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Invalid schedule configuration or missing required fields.
        "401":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Authentication failed. Missing or invalid API key.
      security:
      - bearerAuth: []
      summary: Schedule Recurring Screenshots (Asynchronous)
      tags:
      - Screenshots
      x-content-type: application/json
      x-accepts:
      - application/json
  /v1/ops/screenshots/capture:
    post:
      description: |
        <p>Initiates an asynchronous job to capture a screenshot of a website. Supports various viewport sizes, full-page captures, and JavaScript rendering.</p>
        <p><b>Performance Note:</b> A typical screenshot capture takes 10-30 seconds. Poll the `/v1/ops/jobs/{jobId}` endpoint to retrieve the URL of the final image.</p>
        <p><b>Output:</b> The job result will contain a URL to download the screenshot image in the specified format (PNG, JPEG, or WebP).</p>
      operationId: createScreenshot
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ScreenshotRequest"
        description: The URL and options for the screenshot capture.
        required: true
      responses:
        "202":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/JobResponse"
          description: Screenshot job successfully accepted.
        "400":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Invalid URL or options provided.
        "401":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Authentication failed. Missing or invalid API key.
        "429":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Rate limit exceeded.
      security:
      - bearerAuth: []
      summary: Capture a Website Screenshot (Asynchronous)
      tags:
      - Screenshots
      x-content-type: application/json
      x-accepts:
      - application/json
  /v1/ops/scans/map:
    post:
      description: |
        <p>Creates a comprehensive map of infrastructure relationships starting from a domain or IP. Discovers connected assets through shared hosting, DNS, certificates, and network relationships.</p>
        <h4>Mapping Depth Levels:</h4>
        <ul>
            <li><b>Depth 1:</b> Direct relationships only (~30 seconds, 10-50 assets)</li>
            <li><b>Depth 2:</b> 2 hops out (~2-5 minutes, 50-500 assets)</li>
            <li><b>Depth 3:</b> 3 hops out (~10-30 minutes, 500-5000 assets)</li>
        </ul>
        <h4>Relationship Types Discovered:</h4>
        <ul>
            <li>Domains on same IP</li>
            <li>Domains sharing nameservers</li>
            <li>Domains with same SSL certificate</li>
            <li>IPs in same ASN</li>
            <li>Domains with same registrant</li>
        </ul>
        <h4>Output Format:</h4>
        <p>Results returned as graph data compatible with visualization libraries (nodes and edges).</p>
        <h4>Use Cases:</h4>
        <ul>
            <li>Threat actor infrastructure mapping</li>
            <li>Discovering related phishing domains</li>
            <li>Finding shadow IT and forgotten assets</li>
        </ul>
      operationId: createInfrastructureMap
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/InfrastructureMapRequest"
        description: |
          Mapping configuration. Example:
          ```json
          {
            "startPoint": "example.com",
            "depth": 2
          }
          ```
        required: true
      responses:
        "202":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/JobResponse"
          description: "Mapping job successfully accepted. Poll `/v1/ops/jobs/{jobId}`\
            \ for results."
        "400":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Invalid starting point or depth (must be 1-3).
        "401":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Authentication failed. Missing or invalid API key.
      security:
      - bearerAuth: []
      summary: Map Infrastructure Relationships (Asynchronous)
      tags:
      - Infrastructure Scanning
      x-content-type: application/json
      x-accepts:
      - application/json
  /v1/ops/scans/infrastructure:
    post:
      description: |
        <p>Initiates a security scan of a domain's infrastructure. Performs reconnaissance and configuration analysis.</p>
        <h4>Scan Types:</h4>
        <ul>
            <li><b>comprehensive:</b> Full scan including all modules (subdomains, dns, ssl, technologies, whois)</li>
            <li><b>subdomains:</b> Subdomain enumeration and discovery</li>
            <li><b>ssl:</b> SSL/TLS certificate analysis (issuer, validity, expiration, protocol)</li>
            <li><b>dns:</b> DNS record analysis and configuration</li>
            <li><b>technologies:</b> Technology stack detection via headers and NoctisEyes scan</li>
            <li><b>whois:</b> Domain registration and ownership information</li>
            <li><b>vulnerability:</b> Dedicated vulnerability scan using NoctisEyes (detects security misconfigurations, exposed services, known CVEs)</li>
        </ul>
        <h4>Performance:</h4>
        <ul>
            <li><b>Quick scans:</b> 10-30 seconds (ssl, dns, whois)</li>
            <li><b>Medium scans:</b> 30-60 seconds (subdomains)</li>
            <li><b>Technologies scan:</b> 2-5 minutes (includes NoctisEyes vulnerability scan)</li>
            <li><b>Vulnerability scan:</b> 2-5 minutes (dedicated NoctisEyes security scan with severity breakdown)</li>
            <li><b>Comprehensive scan:</b> 3-5 minutes (all modules in parallel)</li>
        </ul>
        <h4>Use Cases:</h4>
        <ul>
            <li>Pre-engagement reconnaissance for penetration testing</li>
            <li>Attack surface assessment</li>
            <li>SSL certificate monitoring</li>
            <li>Infrastructure inventory</li>
            <li>Vulnerability assessment and security audits</li>
        </ul>
      operationId: createInfrastructureScan
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ScanRequest"
        description: Scan configuration including target domain and scan type.
        required: true
      responses:
        "202":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/JobResponse"
          description: "Scan job successfully accepted. Poll `/v1/ops/jobs/{jobId}`\
            \ for results."
        "400":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Invalid domain or scan type.
        "401":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Authentication failed. Missing or invalid API key.
      security:
      - bearerAuth: []
      summary: Infrastructure Security Scan (Asynchronous)
      tags:
      - Infrastructure Scanning
      x-content-type: application/json
      x-accepts:
      - application/json
  /v1/ops/monitoring:
    get:
      description: |
        <p>Get a list of all monitoring checks created by the authenticated user.</p>
        <h4>Filtering:</h4>
        <ul>
            <li><b>type:</b> Filter by check type (api, ssl, dns)</li>
            <li><b>status:</b> Filter by status (passing, failing, degraded, pending)</li>
        </ul>
      operationId: listMonitorChecks
      parameters:
      - description: Filter by check type
        example: api
        explode: true
        in: query
        name: type
        required: false
        schema:
          type: string
        style: form
      - description: Filter by status
        example: passing
        explode: true
        in: query
        name: status
        required: false
        schema:
          type: string
        style: form
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/MonitorListResponse"
          description: List of monitoring checks.
        "401":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Authentication failed.
      security:
      - bearerAuth: []
      summary: List Monitoring Checks
      tags:
      - Monitoring
      x-accepts:
      - application/json
    post:
      description: |
        <p>Create a new monitoring check to track uptime and performance of a URL or endpoint.</p>
        <h4>Check Types:</h4>
        <ul>
            <li><b>api:</b> HTTP/HTTPS endpoint monitoring - checks status code, response time, content</li>
            <li><b>ssl:</b> SSL certificate monitoring - validates certificate and tracks expiry</li>
            <li><b>dns:</b> DNS record monitoring - validates DNS resolution and record values</li>
        </ul>
        <h4>Frequency Options:</h4>
        <p>Check frequency in minutes: 1, 5, 10, 15, 30, 60, 1440 (daily)</p>
        <h4>Locations:</h4>
        <p>Checks can run from multiple global locations: us-east-1, us-west-1, eu-west-1, ap-southeast-1</p>
      operationId: createMonitorCheck
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/MonitorCheckRequest"
        description: Monitoring check configuration
        required: true
      responses:
        "201":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/MonitorCheckResponse"
          description: Monitoring check created successfully.
        "400":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Invalid request - missing name or URL.
        "401":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Authentication failed.
      security:
      - bearerAuth: []
      summary: Create Monitoring Check
      tags:
      - Monitoring
      x-content-type: application/json
      x-accepts:
      - application/json
  /v1/ops/monitoring/{target}/alert:
    post:
      description: |
        <p>Configure alert notifications for a monitored target. Set up notifications for downtime, SSL expiry, DNS changes, and more.</p>
        <h4>Alert Types:</h4>
        <ul>
            <li><b>downtime:</b> Alert when target becomes unreachable</li>
            <li><b>dns_change:</b> Alert when DNS records change</li>
            <li><b>whois_change:</b> Alert when WHOIS data changes</li>
            <li><b>ssl_expiring:</b> Alert when SSL certificate is expiring (within threshold days)</li>
            <li><b>content_change:</b> Alert when page content changes significantly</li>
            <li><b>technology_change:</b> Alert when detected technologies change</li>
        </ul>
        <h4>Notification Channels:</h4>
        <ul>
            <li><b>email:</b> Send alerts via email</li>
            <li><b>slack:</b> Post to Slack webhook</li>
            <li><b>webhook:</b> POST to custom webhook URL</li>
            <li><b>pagerduty:</b> Create PagerDuty incident</li>
        </ul>
      operationId: createMonitoringAlert
      parameters:
      - description: The domain or IP address to configure alerts for.
        example: example.com
        explode: false
        in: path
        name: target
        required: true
        schema:
          type: string
        style: simple
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/MonitoringAlertRequest"
        description: "Alert configuration including type, thresholds, and notification\
          \ channels."
        required: true
      responses:
        "202":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/JobResponse"
          description: Alert configuration job accepted.
        "400":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Invalid alert configuration.
        "401":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Authentication failed. Missing or invalid API key.
      security:
      - bearerAuth: []
      summary: Configure Monitoring Alert
      tags:
      - Monitoring
      x-content-type: application/json
      x-accepts:
      - application/json
  /v1/ops/monitoring/{checkId}/trigger:
    post:
      description: Trigger an immediate execution of a monitoring check.
      operationId: triggerMonitorCheck
      parameters:
      - description: Check ID
        example: abc123
        explode: false
        in: path
        name: checkId
        required: true
        schema:
          type: string
        style: simple
      responses:
        "202":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/GenericSuccessResponse"
          description: Check triggered successfully.
        "404":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Check not found or access denied.
        "401":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Authentication failed.
      security:
      - bearerAuth: []
      summary: Trigger Manual Check
      tags:
      - Monitoring
      x-accepts:
      - application/json
  /v1/ops/graph/graphql:
    post:
      description: |
        Execute a GraphQL query against the graph database.

        GraphQL provides a type-safe, structured alternative to Cypher
        for querying the graph data.

        **Available Query Operations:**
        - `domain(name: String!)` - Look up domain information
        - `ipv4(address: String!)` - Look up IPv4 address information
        - `ipv6(address: String!)` - Look up IPv6 address information
        - `asn(number: Int!)` - Look up ASN information
        - `searchDomains(pattern: String!, limit: Int)` - Search domains by pattern
        - `domainsOnIP(address: String!)` - Find domains on an IP
        - `domainsOnASN(asnNumber: Int!, limit: Int)` - Find domains on an ASN
        - `checkIndicator(indicator: String!)` - Check if indicator is listed

        **Example Query:**
        ```graphql
        {
          domain(name: "google.com") {
            name
            ipAddresses {
              address
              country { code }
            }
            nameservers { name }
            asns { number }
          }
        }
        ```

        Use the `/v1/ops/graph/graphiql` endpoint for an interactive
        query explorer with schema documentation.
      operationId: executeGraphQL
      parameters:
      - explode: false
        in: header
        name: Authorization
        required: true
        schema:
          type: string
        style: simple
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/GraphQLRequest"
        required: true
      responses:
        "200":
          content:
            application/json: {}
          description: Query executed successfully
        "400":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Invalid query syntax
        "401":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Authentication required
      security:
      - bearerAuth: []
      summary: Execute GraphQL Query
      tags:
      - Graph Database
      x-content-type: application/json
      x-accepts:
      - application/json
  /v1/ops/graph/cypher:
    post:
      description: |
        Execute a read-only Cypher query against the FalkorDB graph database.

        **Security:** Only read operations (MATCH, RETURN) are allowed.
        Write operations are blocked.

        **Example Queries:**
        ```cypher
        // Find all IPs for a domain
        MATCH (d:DomainName {name: $domain})-[:hasIP]->(ip:A_ADDRESS)
        RETURN ip.name AS ip

        // Find domains on blocklists
        MATCH (d:DomainName)-[:isListed]->(l:LIST)
        RETURN d.name, l.name LIMIT 10

        // Get ASN and announced prefixes
        MATCH (asn:ASN {number: 15169})-[:announces]->(p:ANNOUNCED_PREFIX_4)
        RETURN p.name AS prefix
        ```

        **Performance Tips:**
        - Always use LIMIT to restrict result size
        - Use parameters for variable values
        - Filter early in the query with WHERE clauses
      operationId: executeCypherQuery
      parameters:
      - explode: false
        in: header
        name: Authorization
        required: true
        schema:
          type: string
        style: simple
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CypherQueryRequest"
        required: true
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/CypherQueryResponse"
          description: Query executed successfully
        "400":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Invalid query syntax
        "401":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Authentication required
        "500":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Query execution failed
      security:
      - bearerAuth: []
      summary: Execute Cypher Query
      tags:
      - Graph Database
      x-content-type: application/json
      x-accepts:
      - application/json
  /v1/ops/enrichment/similar-domains:
    post:
      description: |
        <p>Finds domains similar to the provided domain using various similarity detection techniques.
        This endpoint is useful for brand protection, typosquatting detection, and threat hunting.</p>

        <h4>Supported Techniques:</h4>
        <p>Specify techniques in the <code>techniques</code> array. If not specified, defaults to <code>typosquatting</code>.</p>
        <ul>
            <li><b>typosquatting</b> - Keyboard proximity errors and common typos (e.g., gooogle.com, gogle.com)</li>
            <li><b>homoglyph</b> - Visually similar Unicode characters (e.g., gооgle.com using Cyrillic 'о')</li>
            <li><b>tld_variation</b> - Different TLD variations (e.g., google.net, google.org)</li>
            <li><b>sounding</b> - Phonetically similar domains</li>
            <li><b>prefix</b> - Domains starting with the target</li>
            <li><b>suffix</b> - Domains ending with the target</li>
            <li><b>contains</b> - Domains containing the target as a substring</li>
            <li><b>levenshtein</b> - Edit distance similarity</li>
        </ul>

        <h4>Example Request:</h4>
        <pre><code>{
          "domain": "google.com",
          "techniques": ["typosquatting", "homoglyph", "tld_variation"],
          "limit": 100
        }</code></pre>

        <h4>Response Format:</h4>
        <p>Poll <code>/v1/ops/jobs/{jobId}</code> to get results. The result contains:</p>
        <pre><code>{
          "domain": "google.com",
          "status": "completed",
          "similarDomains": [
            {"domain": "gooogle.com", "technique": "TYPO"},
            {"domain": "gооgle.com", "technique": "UTFVARS"}
          ],
          "totalCount": 200,
          "analysis": {
            "techniquesUsed": "TYPO,UTFVARS",
            "baseDomain": "google.com",
            "searchLimit": 100
          }
        }</code></pre>

        <h4>Performance:</h4>
        <p>Typically completes in 5-15 seconds. Multiple techniques run in parallel.</p>

        <h4>Note:</h4>
        <p>The <code>check_registration</code>, <code>include_dns</code>, and <code>include_risk_score</code> options
        are not currently supported by the backend service and will be ignored.</p>
      operationId: similarDomains
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/SimilarDomainsOpsRequest"
        description: Similar domains request with domain and options.
        required: true
      responses:
        "202":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/JobResponse"
          description: "Similar domains job created successfully. Poll GET /v1/ops/jobs/{jobId}\
            \ to retrieve results. When completed, the job's `result` field contains\
            \ a SimilarDomainsResponse object."
        "200":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/SimilarDomainsResponse"
          description: "Job result schema (returned via GET /v1/ops/jobs/{jobId} when\
            \ status=COMPLETED). This is NOT returned by this endpoint directly, but\
            \ documents the final result structure."
        "400":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Invalid domain or options.
        "401":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Authentication failed.
      security:
      - bearerAuth: []
      summary: Find Similar Domains (Asynchronous)
      tags:
      - Enrichment
      x-content-type: application/json
      x-accepts:
      - application/json
  /v1/ops/enrichment/search:
    post:
      description: |2
                    <p>Initiates an asynchronous job to search domain registration (WHOIS) or IP geolocation records. This endpoint is extremely powerful for infrastructure discovery, threat hunting, and brand protection.</p>
                    <p><b>Performance Note:</b> WHOIS searches are data-intensive and can take over 50 seconds to complete. Geolocation searches are faster (5-10 seconds). This endpoint is asynchronous by design. Poll the <code>/v1/ops/jobs/{jobId}</code> endpoint to retrieve results.</p>

                    <h4>Search Types:</h4>
                    <p>The endpoint automatically routes to the appropriate backend based on the fields provided:</p>
                    <ul>
                        <li><b>WHOIS Search:</b> Use registrant fields (registrantCompany, registrantEmail, etc.) or domain-related fields (tld, nameServer, etc.)</li>
                        <li><b>Geolocation Search:</b> Use IP geolocation fields (city, country, asn, isp, etc.) to find IPs matching criteria</li>
                    </ul>

                    <h4>WHOIS Search Fields:</h4>
                    <table>
                        <tr><th>Field</th><th>Type</th><th>Description</th></tr>
                        <tr><td><code>tld</code></td><td>exact</td><td>Top-level domain (e.g., "com", "org", "net")</td></tr>
                        <tr><td><code>registrarName</code></td><td>exact</td><td>Domain registrar name</td></tr>
                        <tr><td><code>registrarIanaId</code></td><td>exact</td><td>IANA registrar ID</td></tr>
                        <tr><td><code>registrantName</code></td><td>text</td><td>Domain registrant name (partial match)</td></tr>
                        <tr><td><code>registrantCompany</code></td><td>text</td><td>Registrant organization/company (partial match)</td></tr>
                        <tr><td><code>registrantEmail</code></td><td>text</td><td>Registrant email address (supports *@domain.com wildcards)</td></tr>
                        <tr><td><code>registrantPhone</code></td><td>text</td><td>Registrant phone number</td></tr>
                        <tr><td><code>registrantCountry</code></td><td>text</td><td>2-letter country code (e.g., "US", "DE")</td></tr>
                        <tr><td><code>registrantCity</code></td><td>text</td><td>Registrant city</td></tr>
                        <tr><td><code>nameServer</code></td><td>text</td><td>Name server hostname</td></tr>
                        <tr><td><code>domainStatus</code></td><td>text</td><td>Domain status flag (e.g., "clientTransferProhibited")</td></tr>
                        <tr><td><code>createdDate</code></td><td>exact</td><td>Domain creation date (YYYY-MM-DD format)</td></tr>
                        <tr><td><code>updatedDate</code></td><td>exact</td><td>Domain last update date (YYYY-MM-DD format)</td></tr>
                        <tr><td><code>expiryDate</code></td><td>exact</td><td>Domain expiry date (YYYY-MM-DD format)</td></tr>
                    </table>

                    <h4>Geolocation Search Fields (query string syntax):</h4>
                    <table>
                        <tr><th>Field</th><th>Description</th><th>Example</th></tr>
                        <tr><td><code>city</code></td><td>City name</td><td><code>city:London</code></td></tr>
                        <tr><td><code>country</code></td><td>Country name</td><td><code>country:Germany</code></td></tr>
                        <tr><td><code>asn</code></td><td>Autonomous System Number</td><td><code>asn:15169</code> (Google)</td></tr>
                        <tr><td><code>isp</code></td><td>Internet Service Provider name</td><td><code>isp:Cloudflare</code></td></tr>
                        <tr><td><code>organization</code></td><td>Organization name</td><td><code>organization:Amazon</code></td></tr>
                        <tr><td><code>region</code></td><td>Region/State</td><td><code>region:California</code></td></tr>
                        <tr><td><code>postal_code</code></td><td>Postal/ZIP code</td><td><code>postal_code:94043</code></td></tr>
                        <tr><td><code>continent</code></td><td>Continent</td><td><code>continent:Europe</code></td></tr>
                    </table>

                    <h4>Example Requests:</h4>
                    <p><b>WHOIS search (field-based):</b></p>
                    <pre>{
          "registrantCompany": "Google",
          "registrantCountry": "US",
          "limit": 100,
          "page": 0
        }</pre>
                    <p><b>Geolocation search (find IPs by ASN):</b></p>
                    <pre>{
          "query": "asn:15169",
          "limit": 100
        }</pre>
                    <p><b>Geolocation search (find IPs by city):</b></p>
                    <pre>{
          "query": "city:Mountain View",
          "limit": 100
        }</pre>
                    <p><b>Date-based domain search:</b></p>
                    <pre>{
          "createdDate": "2024-01-15",
          "tld": "com",
          "limit": 100
        }</pre>

                    <h4>Pagination:</h4>
                    <ul>
                        <li><code>limit</code>: Maximum 100 results per page (default: 100)</li>
                        <li><code>page</code>: 0-indexed page number (default: 0)</li>
                        <li><code>offset</code>: Alternative to page - number of results to skip</li>
                    </ul>

                    <h4>Use Cases:</h4>
                    <ul>
                        <li><b>Threat hunting:</b> Find domains/IPs registered by known malicious actors</li>
                        <li><b>Infrastructure mapping:</b> Find all IPs in a specific ASN or organization</li>
                        <li><b>Brand protection:</b> Monitor for domains similar to your brand</li>
                        <li><b>Geolocation analysis:</b> Find IPs in specific geographic regions</li>
                        <li><b>Investigation:</b> Track domains created on specific dates or IPs from specific ISPs</li>
                    </ul>

                    <h4>Security:</h4>
                    <p>All search parameters are validated for:</p>
                    <ul>
                        <li>SQL injection prevention</li>
                        <li>Command injection prevention</li>
                        <li>Input length limits</li>
                        <li>Format validation (dates, emails, country codes, etc.)</li>
                    </ul>
      operationId: searchIndicators
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/SearchRequest"
        description: The search query and configuration.
        required: true
      responses:
        "202":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/JobResponse"
          description: "Search job successfully accepted. Poll GET /v1/ops/jobs/{jobId}\
            \ to retrieve results. When completed, the job's `result` field contains\
            \ a SearchResponse object."
        "200":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/SearchResponse"
          description: "Job result schema (returned via GET /v1/ops/jobs/{jobId} when\
            \ status=COMPLETED). This is NOT returned by this endpoint directly, but\
            \ documents the final result structure."
        "400":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Invalid search query or parameters.
        "401":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Authentication failed. Missing or invalid API key.
        "429":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Rate limit exceeded for search operations.
      security:
      - bearerAuth: []
      summary: Search WHOIS and Geolocation Records (Asynchronous)
      tags:
      - Enrichment
      x-content-type: application/json
      x-accepts:
      - application/json
  /v1/ops/enrichment/bulk:
    post:
      description: |
        <p>Process multiple indicators (IPs and/or domains) in a single request. This endpoint is optimized for batch processing and can handle up to 100 indicators per request.</p>

        <h4>Performance</h4>
        <p>Processing time depends on batch size and indicator types. IP enrichment is faster than domain enrichment.</p>
        <ul>
            <li><b>IPs only:</b> 2-10 seconds for typical batches</li>
            <li><b>Domains only:</b> 10-30 seconds (WHOIS lookups are slower)</li>
            <li><b>Mixed:</b> 5-30 seconds depending on ratio</li>
        </ul>

        <h4>Rate Limits</h4>
        <p>Limited to 10 requests per minute due to the resource-intensive nature of bulk operations.</p>

        <h4>Response Structure</h4>
        <p>When the job completes, the <code>result</code> field contains:</p>
        <ul>
            <li><code>status</code>: "completed" or "failed"</li>
            <li><code>results</code>: Array of enriched indicator objects (see below)</li>
            <li><code>errors</code>: Array of failed enrichments with error details</li>
            <li><code>totalProcessed</code>: Number of indicators processed</li>
            <li><code>totalFailed</code>: Number of failed enrichments</li>
            <li><code>totalIndicators</code>: Total indicators in request</li>
            <li><code>successRate</code>: Percentage of successful enrichments (0-100)</li>
        </ul>

        <h4>Result Item Structure</h4>
        <p>Each item in the <code>results</code> array includes:</p>
        <ul>
            <li><code>indicator</code>: The original indicator value</li>
            <li><code>type</code>: "ip" or "domain"</li>
            <li><code>query</code>: Request metadata (type, value, timestamp, response_time_ms)</li>
            <li><code>summary</code>: Key information summary</li>
        </ul>

        <p><b>For IP indicators:</b></p>
        <ul>
            <li><code>geolocation</code>: Country, city, coordinates, ISP, ASN</li>
            <li><code>network</code>: BGP routing data, prefix visibility, origins</li>
            <li><code>isp</code>: ISP name, organization, ASN</li>
            <li><code>reputation</code>: Risk score, blacklist scores</li>
            <li><code>relationships</code>: Related domains, shared infrastructure</li>
        </ul>

        <p><b>For domain indicators:</b></p>
        <ul>
            <li><code>registration</code>: WHOIS data (registrar, dates, nameservers, status)</li>
            <li><code>dns</code>: DNS records (A, AAAA, MX, NS, TXT, CNAME)</li>
            <li><code>reputation</code>: Domain reputation, infrastructure scores</li>
            <li><code>relationships</code>: Related domains, incoming/outgoing links</li>
        </ul>

        <h4>Error Item Structure</h4>
        <p>Each item in the <code>errors</code> array includes:</p>
        <ul>
            <li><code>indicator</code>: The indicator that failed</li>
            <li><code>type</code>: "ip" or "domain"</li>
            <li><code>error</code>: true</li>
            <li><code>message</code>: Error description</li>
        </ul>
      operationId: bulkEnrichment
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/BulkRequest"
        description: List of indicators and processing options.
        required: true
      responses:
        "202":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/JobResponse"
          description: "Bulk job successfully accepted for processing. Poll GET /v1/ops/jobs/{jobId}\
            \ for results."
        "200":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/BulkEnrichmentResult"
          description: "Job result schema (returned via GET /v1/ops/jobs/{jobId} when\
            \ job completes). See endpoint description for detailed result structure."
        "400":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Invalid request. Empty indicator list or exceeds 100 indicator
            limit.
        "401":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Authentication failed. Missing or invalid API key.
        "429":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Rate limit exceeded for bulk operations.
      security:
      - bearerAuth: []
      summary: Bulk Indicator Enrichment (Asynchronous)
      tags:
      - Enrichment
      x-content-type: application/json
      x-accepts:
      - application/json
  /v1/ops/ai/similar-cases:
    post:
      description: |
        <p>Uses ML to find historical threat cases similar to the current investigation. Helps analysts understand attack patterns and expected outcomes.</p>
        <h4>Matching Criteria:</h4>
        <ul>
            <li>Indicator overlap and relationships</li>
            <li>Behavioral patterns and TTPs</li>
            <li>Infrastructure characteristics</li>
            <li>Attack progression similarities</li>
        </ul>
        <h4>Response Includes:</h4>
        <ul>
            <li>Similar cases with similarity scores</li>
            <li>Case outcomes and verdicts</li>
            <li>Common patterns across matches</li>
        </ul>
        <h4>Performance:</h4>
        <p>ML similarity matching. Expected completion: 5-30 seconds.</p>
      operationId: findSimilarCases
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/SimilarCasesRequest"
        description: Similar cases request
        required: true
      responses:
        "202":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/JobResponse"
          description: "Similar cases search job accepted. Poll GET /v1/ops/jobs/{jobId}\
            \ for results."
        "200":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/SimilarCasesResult"
          description: "Job result schema (returned via GET /v1/ops/jobs/{jobId} when\
            \ job completes)"
        "400":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Invalid request.
        "401":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Authentication failed.
      security:
      - bearerAuth: []
      summary: Find Similar Cases (Asynchronous)
      tags:
      - AI Intelligence
      x-content-type: application/json
      x-accepts:
      - application/json
  /v1/ops/ai/pivot:
    post:
      description: |
        <p>Performs intelligent infrastructure pivoting starting from an indicator. Uses ML to identify the most relevant relationships and suggest investigation paths.</p>
        <h4>Pivot Strategies:</h4>
        <ul>
            <li><b>infrastructure:</b> Shared hosting, nameservers, certificates</li>
            <li><b>registration:</b> Same registrant, registration patterns</li>
            <li><b>behavioral:</b> Similar traffic patterns, communication</li>
            <li><b>temporal:</b> Co-occurrence within time windows</li>
        </ul>
        <h4>Response Includes:</h4>
        <ul>
            <li>Discovered related indicators with relevance scores</li>
            <li>Suggested investigation paths ranked by priority</li>
            <li>Relationship graph data</li>
        </ul>
        <h4>Performance:</h4>
        <p>Graph traversal with ML ranking. Expected: 10-120 seconds based on depth.</p>
      operationId: aiPivot
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/PivotRequest"
        description: Pivot request
        required: true
      responses:
        "202":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/JobResponse"
          description: "Pivot analysis job accepted. Poll GET /v1/ops/jobs/{jobId}\
            \ for results."
        "200":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PivotResult"
          description: "Job result schema (returned via GET /v1/ops/jobs/{jobId} when\
            \ job completes)"
        "400":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Invalid request.
        "401":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Authentication failed.
      security:
      - bearerAuth: []
      summary: AI Infrastructure Pivot (Asynchronous)
      tags:
      - AI Intelligence
      x-content-type: application/json
      x-accepts:
      - application/json
  /v1/ops/ai/investigate:
    post:
      description: |
        <p>Initiates a comprehensive AI-powered threat investigation for an indicator. Uses large language models to analyze threat intelligence, generate insights, and provide actionable recommendations.</p>
        <h4>Investigation Output:</h4>
        <ul>
            <li><b>Verdict:</b> Threat assessment with confidence score</li>
            <li><b>Timeline:</b> Activity timeline reconstruction</li>
            <li><b>Analysis:</b> Detailed findings from multiple data sources</li>
            <li><b>Related Indicators:</b> Discovered related infrastructure</li>
            <li><b>Recommendations:</b> Suggested response actions</li>
        </ul>
        <h4>Performance:</h4>
        <p>LLM-based analysis. Expected completion: 30-180 seconds depending on complexity.</p>
      operationId: aiInvestigate
      requestBody:
        content:
          application/json:
            examples:
              Investigate IP:
                description: Investigate IP
                value:
                  indicator: 8.8.8.8
                  indicatorType: ip
                  depth: standard
                  context:
                    hypothesis: Suspicious outbound connection detected
            schema:
              $ref: "#/components/schemas/InvestigateRequest"
        description: |
          Investigation request. Required fields:
          - **indicator**: The IP, domain, or hash to investigate
          - **indicatorType**: Must be "ip", "domain", or "hash"

          Optional fields:
          - **depth**: Investigation depth ("quick", "standard", "comprehensive"). Default: "standard"
          - **context**: Object with optional fields: hypothesis (string), relatedIndicators (array), timeRange (string)
        required: true
      responses:
        "202":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/JobResponse"
          description: "Investigation job accepted. Poll GET /v1/ops/jobs/{jobId}\
            \ for results."
        "200":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvestigateResult"
          description: "Job result schema (returned via GET /v1/ops/jobs/{jobId} when\
            \ job completes)"
        "400":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Invalid request.
        "401":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Authentication failed.
      security:
      - bearerAuth: []
      summary: AI Threat Investigation (Asynchronous)
      tags:
      - AI Intelligence
      x-content-type: application/json
      x-accepts:
      - application/json
  /v1/ops/ai/correlate:
    post:
      description: |
        <p>Correlates your indicators against anonymized global threat data from all customers. Identifies shared campaigns, widespread threats, and prevalence across industries.</p>
        <h4>Correlation Analysis:</h4>
        <ul>
            <li><b>Prevalence:</b> How common are these indicators across our customer base</li>
            <li><b>Industry Breakdown:</b> Which industries are seeing these indicators</li>
            <li><b>Campaign Detection:</b> Are these part of a broader campaign</li>
            <li><b>First/Last Seen:</b> Global timeline of indicator activity</li>
            <li><b>Co-occurrence:</b> Indicators frequently seen together</li>
        </ul>
        <h4>Limitations:</h4>
        <p>Maximum 100 indicators per request.</p>
        <h4>Performance:</h4>
        <p>Cross-customer correlation. Expected: 10-60 seconds.</p>
      operationId: aiCorrelate
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CorrelateRequest"
        description: Correlation request
        required: true
      responses:
        "202":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/JobResponse"
          description: "Correlation job accepted. Poll GET /v1/ops/jobs/{jobId} for\
            \ results."
        "200":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/CorrelateResult"
          description: "Job result schema (returned via GET /v1/ops/jobs/{jobId} when\
            \ job completes)"
        "400":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Invalid request or exceeds 100 indicator limit.
        "401":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Authentication failed.
      security:
      - bearerAuth: []
      summary: Global Indicator Correlation (Asynchronous)
      tags:
      - AI Intelligence
      x-content-type: application/json
      x-accepts:
      - application/json
  /v1/ops/ai/attribute:
    post:
      description: |
        <p>Analyzes indicators and context to identify potential threat actors and campaigns. Uses ML clustering and TTP matching against known threat actor profiles.</p>
        <h4>Attribution Analysis:</h4>
        <ul>
            <li><b>Actor Identification:</b> Potential threat actor matches with confidence</li>
            <li><b>Campaign Clustering:</b> Groups indicators into potential campaigns</li>
            <li><b>TTP Mapping:</b> MITRE ATT&CK technique mapping</li>
            <li><b>Historical Context:</b> Known actor activity patterns</li>
        </ul>
        <h4>Limitations:</h4>
        <p>Maximum 500 indicators per request. Attribution is probabilistic and should be validated.</p>
        <h4>Performance:</h4>
        <p>Campaign clustering and analysis. Expected: 60-300 seconds.</p>
      operationId: aiAttribute
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/AttributeRequest"
        description: Attribution request
        required: true
      responses:
        "202":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/JobResponse"
          description: "Attribution analysis job accepted. Poll GET /v1/ops/jobs/{jobId}\
            \ for results."
        "200":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AttributeResult"
          description: "Job result schema (returned via GET /v1/ops/jobs/{jobId} when\
            \ job completes)"
        "400":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Invalid request or exceeds 500 indicator limit.
        "401":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Authentication failed.
      security:
      - bearerAuth: []
      summary: Threat Actor Attribution (Asynchronous)
      tags:
      - AI Intelligence
      x-content-type: application/json
      x-accepts:
      - application/json
  /v1/location/ips/bulk:
    post:
      description: |
        <p>Retrieve geolocation data for up to 1000 IP addresses in a single request. Optimized for batch processing with parallel lookups.</p>
        <h4>Request Format:</h4>
        <p>Send a JSON object with an <code>ips</code> array:</p>
        <pre><code>{"ips": ["8.8.8.8", "1.1.1.1", "208.67.222.222"]}</code></pre>
        <h4>Performance:</h4>
        <ul>
            <li><b>Response Time:</b> 2-5 seconds for small batches (1-10 IPs), 5-15 seconds for larger batches</li>
            <li><b>Processing:</b> Parallel lookups with concurrency of 10</li>
            <li><b>Limit:</b> Maximum 1000 IPs per request</li>
            <li><b>Rate Limit:</b> 10 requests per minute</li>
        </ul>
        <h4>Response Format:</h4>
        <p>Returns an array of geolocation objects, one for each requested IP:</p>
        <p><b>Successful lookup fields:</b></p>
        <ul>
            <li><code>queriedIp</code>: The IP address that was looked up (for correlation)</li>
            <li><code>country</code>: Object with <code>isoCode</code> (e.g., "US"), <code>name</code> (e.g., "United States")</li>
            <li><code>city</code>: Object with <code>name</code> (e.g., "Mountain View")</li>
            <li><code>location</code>: Object with <code>latitude</code>, <code>longitude</code>, <code>timeZone</code></li>
            <li><code>isp</code>: Object with <code>name</code>, <code>organization</code>, <code>asn</code>, <code>asnOrganization</code></li>
            <li><code>coordinates</code>: Object with <code>latitude</code>, <code>longitude</code> (convenience field)</li>
            <li><code>traits</code>: Object with <code>userType</code> (e.g., "hosting", "residential")</li>
        </ul>
        <p><b>Failed lookup fields:</b></p>
        <ul>
            <li><code>ip</code>: The IP address that failed</li>
            <li><code>error</code>: Always <code>true</code> for failed lookups</li>
            <li><code>message</code>: Error description (e.g., "Invalid IP address format", "Location data not available for private IP addresses", "Location data not available for reserved/bogon IP addresses")</li>
        </ul>
        <h4>Use Cases:</h4>
        <ul>
            <li>Batch enrichment of access logs</li>
            <li>Bulk fraud scoring</li>
            <li>Geographic distribution analysis</li>
            <li>Network infrastructure mapping</li>
        </ul>
      operationId: getBulkIpLocation
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/BulkIpLocationRequest"
        description: List of IP addresses to lookup. Maximum 1000 IPs per request.
        required: true
      responses:
        "200":
          content:
            application/json: {}
          description: Successfully retrieved bulk geolocation data. Returns an array
            of geolocation objects or error objects for each IP.
        "400":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: "Invalid request format. Missing or empty 'ips' field, or array\
            \ exceeds 1000 IP limit."
        "401":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Authentication failed. Missing or invalid API key.
        "429":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Rate limit exceeded for bulk operations.
      security:
      - bearerAuth: []
      summary: Bulk IP Geolocation Lookup
      tags:
      - Location
      x-content-type: application/json
      x-accepts:
      - application/json
  /v1/ops/tracking:
    get:
      description: |
        <p>Get a list of all indicators currently being tracked for changes by the authenticated user.</p>
      operationId: listTrackedIndicators
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/TrackedIndicatorsResponse"
          description: List of tracked indicators.
        "401":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Authentication failed.
      security:
      - bearerAuth: []
      summary: List Tracked Indicators
      tags:
      - Change Tracking
      x-accepts:
      - application/json
  /v1/ops/screenshots/schedules:
    get:
      description: |
        <p>Retrieve all scheduled screenshot configurations for your API key. Each API key can have a maximum of 3 active schedules.</p>
        <h4>Response Includes:</h4>
        <ul>
            <li><b>Schedule ID:</b> Unique identifier for the schedule</li>
            <li><b>URL:</b> Target website being captured</li>
            <li><b>Frequency:</b> How often screenshots are taken</li>
            <li><b>Next Capture:</b> When the next screenshot will be taken</li>
            <li><b>Capture Count:</b> Total screenshots taken by this schedule</li>
            <li><b>Status:</b> Whether the schedule is enabled or paused</li>
        </ul>
        <h4>Limits:</h4>
        <ul>
            <li><b>Max Schedules:</b> 3 per API key</li>
            <li><b>Max Screenshots:</b> 50 retained per schedule (oldest deleted automatically)</li>
            <li><b>Schedule Expiration:</b> Schedules auto-expire after 90 days of inactivity</li>
        </ul>
      operationId: listScreenshotSchedules
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ScreenshotScheduleListResponse"
          description: Successfully retrieved schedule list.
        "401":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Authentication failed. Missing or invalid API key.
      security:
      - bearerAuth: []
      summary: List Screenshot Schedules
      tags:
      - Screenshots
      x-accepts:
      - application/json
  /v1/ops/screenshots/schedules/{scheduleId}:
    delete:
      description: |
        <p>Delete a scheduled screenshot configuration and optionally all its captured screenshots.</p>
        <p><b>Warning:</b> This action cannot be undone. All associated screenshots will be permanently deleted.</p>
      operationId: deleteScreenshotSchedule
      parameters:
      - description: The schedule ID to delete
        example: sched_abc123
        explode: false
        in: path
        name: scheduleId
        required: true
        schema:
          type: string
        style: simple
      responses:
        "200":
          content:
            '*/*':
              schema:
                type: object
          description: Schedule successfully deleted.
        "404":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Schedule not found or does not belong to your API key.
      security:
      - bearerAuth: []
      summary: Delete Screenshot Schedule
      tags:
      - Screenshots
      x-accepts:
      - '*/*'
      - application/json
    get:
      description: |
        <p>Retrieve details for a specific screenshot schedule including configuration and capture history.</p>
      operationId: getScreenshotSchedule
      parameters:
      - description: The schedule ID
        example: sched_abc123
        explode: false
        in: path
        name: scheduleId
        required: true
        schema:
          type: string
        style: simple
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ScreenshotSchedule"
          description: Successfully retrieved schedule details.
        "404":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Schedule not found or does not belong to your API key.
      security:
      - bearerAuth: []
      summary: Get Screenshot Schedule Details
      tags:
      - Screenshots
      x-accepts:
      - application/json
  /v1/ops/screenshots/history:
    get:
      description: |
        <p>Retrieve all previously captured screenshots for a specific URL, ordered by capture time (newest first). Includes download URLs and metadata for each capture.</p>
        <h4>Response Includes:</h4>
        <ul>
            <li><b>Download URL:</b> Direct link to screenshot image</li>
            <li><b>Capture Time:</b> Timestamp when screenshot was taken</li>
            <li><b>Dimensions:</b> Image width and height</li>
            <li><b>Format:</b> Image format (PNG, JPEG, WebP)</li>
            <li><b>File Size:</b> Size in bytes</li>
        </ul>
        <h4>Use Cases:</h4>
        <ul>
            <li>Review website evolution over time</li>
            <li>Compare screenshots for change detection</li>
            <li>Download historical screenshots for reporting</li>
        </ul>
      operationId: getScreenshotHistory
      parameters:
      - description: The target domain or URL to retrieve screenshot history for.
        example: example.com
        explode: true
        in: query
        name: target
        required: true
        schema:
          type: string
        style: form
      - description: Maximum number of screenshots to return.
        example: 10
        explode: true
        in: query
        name: limit
        required: false
        schema:
          default: 10
          format: int32
          type: integer
        style: form
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ScreenshotHistoryResponse"
          description: Successfully retrieved screenshot history.
        "400":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Invalid URL parameter.
        "401":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Authentication failed. Missing or invalid API key.
        "404":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: No screenshots found for the specified URL.
      security:
      - bearerAuth: []
      summary: Get Screenshot History
      tags:
      - Screenshots
      x-accepts:
      - application/json
  /v1/ops/monitoring/{checkId}/results:
    get:
      description: |
        <p>Get the execution history for a monitoring check.</p>
        <h4>Response includes for each result:</h4>
        <ul>
            <li>Timestamp of execution</li>
            <li>Success/failure status</li>
            <li>Response time</li>
            <li>HTTP status code (for API checks)</li>
            <li>Error message (if failed)</li>
        </ul>
      operationId: getMonitorResults
      parameters:
      - description: Check ID
        example: abc123
        explode: false
        in: path
        name: checkId
        required: true
        schema:
          type: string
        style: simple
      - description: Maximum number of results to return
        example: 10
        explode: true
        in: query
        name: limit
        required: false
        schema:
          default: 10
          format: int32
          type: integer
        style: form
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/MonitorResultListResponse"
          description: Check execution history.
        "404":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Check not found or access denied.
        "401":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Authentication failed.
      security:
      - bearerAuth: []
      summary: Get Check Results
      tags:
      - Monitoring
      x-accepts:
      - application/json
  /v1/ops/monitoring/status/{target}:
    get:
      description: |
        <p>Get the current monitoring status and metrics for a domain or IP address.</p>
        <h4>Metrics Returned:</h4>
        <ul>
            <li>Uptime percentage (last 30 days)</li>
            <li>Average response time</li>
            <li>SSL certificate expiration countdown</li>
            <li>DNS change events</li>
            <li>WHOIS change events</li>
        </ul>
      operationId: getMonitoringStatus
      parameters:
      - description: The domain or IP address to check monitoring status for.
        example: example.com
        explode: false
        in: path
        name: target
        required: true
        schema:
          type: string
        style: simple
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/MonitoringStatusResponse"
          description: Successfully retrieved monitoring status.
        "401":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Authentication failed. Missing or invalid API key.
        "404":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Target is not being monitored.
      security:
      - bearerAuth: []
      summary: Get Monitoring Status
      tags:
      - Monitoring
      x-accepts:
      - application/json
  /v1/ops/monitoring/dashboard:
    get:
      description: |
        <p>Get aggregated dashboard statistics for all monitoring checks.</p>
        <h4>Includes:</h4>
        <ul>
            <li>Total, passing, failing, and degraded check counts</li>
            <li>Average uptime percentages (24h, 7d, 30d)</li>
            <li>Average response time</li>
            <li>Checks grouped by type and status</li>
        </ul>
      operationId: getMonitorDashboard
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/MonitorDashboardResponse"
          description: Dashboard summary.
        "401":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Authentication failed.
      security:
      - bearerAuth: []
      summary: Get Monitoring Dashboard
      tags:
      - Monitoring
      x-accepts:
      - application/json
  /v1/ops/jobs/{jobId}:
    get:
      description: |
        <p>Retrieves the current status and results of an asynchronous job. Poll this endpoint to check job progress.</p>
        <h4>Polling Recommendations:</h4>
        <ul>
            <li>For fast jobs (e.g., similar domains), poll every 1-2 seconds.</li>
            <li>For slow jobs (e.g., WHOIS search, screenshots), poll every 5-10 seconds.</li>
            <li>Implement an exponential backoff strategy for very long-running jobs.</li>
            <li>Stop polling when the status is `COMPLETED`, `FAILED`, or `CANCELLED`.</li>
        </ul>
        <h4>Job Statuses:</h4>
        <ul>
            <li><b>PENDING:</b> Job is queued and waiting to start.</li>
            <li><b>PROCESSING:</b> Job is actively being processed.</li>
            <li><b>COMPLETED:</b> Job finished successfully, results are available.</li>
            <li><b>FAILED:</b> Job failed with an error.</li>
            <li><b>CANCELLED:</b> Job was cancelled by user or system.</li>
        </ul>
        <h4>Result Schemas by Job Type:</h4>
        <ul>
            <li><b>ai-investigate:</b> InvestigateResult - verdict, timeline, analysis, recommendations</li>
            <li><b>ai-pivot:</b> PivotResult - related indicators, investigation paths, relationship graph</li>
            <li><b>ai-attribute:</b> AttributeResult - actor identification, campaign clustering, TTP mapping</li>
            <li><b>ai-correlate:</b> CorrelateResult - prevalence, industry breakdown, co-occurrence</li>
            <li><b>ai-similar-cases:</b> SimilarCasesResult - similar cases with similarity scores</li>
            <li><b>screenshot:</b> ScreenshotResult - screenshot URL, ID, capture time, metadata</li>
        </ul>
      operationId: getJob
      parameters:
      - description: "The unique ID of the job, returned from a `POST` operation."
        example: f6250320-9ed4-442b-a389-acfda52d9375
        explode: false
        in: path
        name: jobId
        required: true
        schema:
          type: string
        style: simple
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Job"
          description: Job status and results retrieved successfully.
        "401":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Authentication failed. Missing or invalid API key.
        "404":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Job ID not found.
      security:
      - bearerAuth: []
      summary: Get Asynchronous Job Status and Results
      tags:
      - Jobs
      x-accepts:
      - application/json
  /v1/ops/jobs/list:
    get:
      description: |
        <p>Retrieves a list of recent jobs for the authenticated user, optionally filtered by status.</p>
        <h4>Query Parameters:</h4>
        <ul>
            <li><b>status:</b> Filter by job status (PENDING, PROCESSING, COMPLETED, FAILED, CANCELLED)</li>
            <li><b>limit:</b> Maximum number of jobs to return (default: 50, max: 100)</li>
            <li><b>offset:</b> Number of jobs to skip for pagination (default: 0)</li>
        </ul>
        <h4>Response Format:</h4>
        <p>Returns a JSON object with a "jobs" array containing job summaries.</p>
      operationId: listJobs
      parameters:
      - description: Filter by job status
        explode: true
        in: query
        name: status
        required: false
        schema:
          type: string
        style: form
      - description: Maximum number of jobs to return
        explode: true
        in: query
        name: limit
        required: false
        schema:
          default: 50
          format: int32
          type: integer
        style: form
      - description: Number of jobs to skip
        explode: true
        in: query
        name: offset
        required: false
        schema:
          default: 0
          format: int32
          type: integer
        style: form
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/JobListResponse"
          description: Successfully retrieved job list.
        "401":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Authentication failed. Missing or invalid API key.
      security:
      - bearerAuth: []
      summary: List Recent Jobs
      tags:
      - Jobs
      x-accepts:
      - application/json
  /v1/ops/graph/schema:
    get:
      description: |
        Retrieve the graph database schema including available node labels,
        relationship types, and their properties.

        Use this to discover what data is available for querying before
        writing Cypher or GraphQL queries.

        **Response includes:**
        - Node labels (e.g., DomainName, A_ADDRESS, ASN)
        - Relationship types (e.g., hasIP, isListed, announces)
        - Properties available on each node and relationship type
        - Graph statistics (node and relationship counts)
      operationId: getSchema
      parameters:
      - explode: false
        in: header
        name: Authorization
        required: true
        schema:
          type: string
        style: simple
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/CypherSchemaResponse"
          description: Schema retrieved successfully
        "401":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Authentication required
        "500":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Failed to retrieve schema
      security:
      - bearerAuth: []
      summary: Get Graph Schema
      tags:
      - Graph Database
      x-accepts:
      - application/json
  /v1/ops/graph/health:
    get:
      description: |
        Check the health and connectivity of the graph database.

        **No authentication required** - this is a public health endpoint.

        Returns database status, connection info, and basic statistics.
      operationId: getHealth
      responses:
        "200":
          content:
            '*/*':
              schema:
                $ref: "#/components/schemas/JsonNode"
          description: Health status retrieved
      summary: Graph Database Health Check
      tags:
      - Graph Database
      x-accepts:
      - '*/*'
  /v1/ops/graph/graphiql:
    get:
      description: |
        Access the GraphiQL interactive query explorer.

        GraphiQL provides:
        - Interactive query editor with syntax highlighting
        - Auto-complete for types and fields
        - Schema documentation browser
        - Query history

        **No authentication required** - the UI itself is public,
        but queries still require a valid API key.
      operationId: getGraphiQL
      responses:
        "200":
          content:
            text/html: {}
          description: GraphiQL HTML page
      summary: GraphiQL Interactive Explorer
      tags:
      - Graph Database
      x-accepts:
      - text/html
  /v1/ops/ai/benchmark/{industry}:
    get:
      description: |
        <p>Returns anonymized, aggregated security metrics for your industry vertical. Compare your security posture against peers.</p>
        <h4>Available Industries:</h4>
        <ul>
            <li>financial_services, healthcare, technology, retail, manufacturing</li>
            <li>energy, telecommunications, government, education, media</li>
        </ul>
        <h4>Metrics Included:</h4>
        <ul>
            <li><b>Risk Scores:</b> Average risk score, percentiles (25th, 50th, 75th, 90th)</li>
            <li><b>Response Metrics:</b> Mean time to detect (MTTD), mean time to respond (MTTR)</li>
            <li><b>Detection Metrics:</b> Detection rate, false positive rate</li>
            <li><b>Threat Profile:</b> Top threats, common attack vectors, targeted assets</li>
            <li><b>Trends:</b> 30-day risk trend direction and change percentage</li>
        </ul>
        <h4>Performance:</h4>
        <p>Pre-aggregated data. Response time typically under 500ms with 1-hour cache.</p>
      operationId: getIndustryBenchmark
      parameters:
      - description: Industry vertical code
        example: financial_services
        explode: false
        in: path
        name: industry
        required: true
        schema:
          enum:
          - financial_services
          - healthcare
          - technology
          - retail
          - manufacturing
          - energy
          - telecommunications
          - government
          - education
          - media
          type: string
        style: simple
      - description: Organization size filter. Compares against organizations of similar
          size.
        example: enterprise
        explode: true
        in: query
        name: size
        required: false
        schema:
          enum:
          - small
          - medium
          - large
          - enterprise
          type: string
        style: form
      - description: Geographic region filter. Compares against organizations in the
          same region.
        example: north_america
        explode: true
        in: query
        name: region
        required: false
        schema:
          enum:
          - global
          - north_america
          - europe
          - asia_pacific
          - latin_america
          - middle_east
          - africa
          type: string
        style: form
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/BenchmarkResponse"
          description: Successfully retrieved industry benchmark.
        "400":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Invalid industry code.
        "401":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Authentication failed.
      security:
      - bearerAuth: []
      summary: Get Industry Security Benchmark (Synchronous)
      tags:
      - AI Intelligence
      x-accepts:
      - application/json
  /v1/location/stats:
    get:
      description: |
        <p>Returns metadata and statistics about the geolocation database, including coverage, update frequency, and data quality metrics.</p>
        <h4>Statistics Included:</h4>
        <ul>
            <li><b>Coverage:</b> Total IP addresses, networks, and ASNs covered</li>
            <li><b>Geographic:</b> Number of countries, cities, and regions</li>
            <li><b>Freshness:</b> Last update timestamp and update frequency</li>
            <li><b>Data Sources:</b> Providers and data collection methods</li>
            <li><b>Accuracy:</b> Quality metrics and confidence scores</li>
        </ul>
        <h4>Performance:</h4>
        <p><b>Note:</b> This endpoint aggregates data from the entire database and may take 5-10 seconds to respond. Consider caching results on your end for repeated access.</p>
        <h4>Use Cases:</h4>
        <ul>
            <li>Verifying database coverage for your use case</li>
            <li>Monitoring data freshness</li>
            <li>Understanding data quality and accuracy</li>
        </ul>
      operationId: getLocationStats
      responses:
        "200":
          content:
            application/json: {}
          description: Successfully retrieved database statistics.
        "401":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Authentication failed. Missing or invalid API key.
      security:
      - bearerAuth: []
      summary: Get Geolocation Database Statistics
      tags:
      - Location
      x-accepts:
      - application/json
  /v1/location/search:
    get:
      description: |
        <p>Search the geolocation database by specific fields to find all IP addresses matching your criteria. Powerful for threat hunting, infrastructure discovery, and pattern analysis.</p>
        <h4>Searchable Fields:</h4>
        <ul>
            <li><b>Geographic:</b> city, country, country_code, region, postal_code, continent, continent_code</li>
            <li><b>Network:</b> asn, as_number, organization, isp, isp_name</li>
            <li><b>Coordinates:</b> latitude, longitude</li>
        </ul>
        <h4>Query Examples:</h4>
        <ul>
            <li><b>Find all IPs in a city:</b> field=city&value=London</li>
            <li><b>Find all IPs for an ASN:</b> field=asn&value=15169</li>
            <li><b>Find all IPs for an ISP:</b> field=isp_name&value=Google</li>
            <li><b>Find all IPs in country:</b> field=country_code&value=US</li>
        </ul>
        <h4>Result Limiting:</h4>
        <ul>
            <li>Use the <code>limit</code> parameter to control the number of results (max 1000, default 100)</li>
            <li><b>Note:</b> Pagination is not currently supported. Use smaller <code>limit</code> values for faster responses.</li>
        </ul>
        <h4>Performance:</h4>
        <ul>
            <li><b>Response Time:</b> 200-500ms depending on result size</li>
            <li><b>Rate Limit:</b> 5 searches per minute</li>
        </ul>
        <h4>Response Format:</h4>
        <ul>
            <li><code>totalHits</code>: Total number of matching records in the database</li>
            <li><code>results</code>: Array of matching IP records (up to <code>limit</code>)</li>
            <li><code>timeTakenMs</code>: Query execution time in milliseconds</li>
        </ul>
        <h4>Use Cases:</h4>
        <ul>
            <li>Infrastructure mapping for threat actors</li>
            <li>Finding all IPs in a specific region for compliance</li>
            <li>Discovering VPN/proxy exit nodes</li>
            <li>Threat hunting by ISP or ASN</li>
        </ul>
      operationId: searchLocation
      parameters:
      - description: "The field to search. Valid fields: city, country, country_code,\
          \ isp_name, isp, asn, as_number, organization, continent, continent_code,\
          \ region, postal_code, latitude, longitude"
        example: city
        explode: true
        in: query
        name: field
        required: true
        schema:
          type: string
        style: form
      - description: The value to search for in the specified field.
        example: San Francisco
        explode: true
        in: query
        name: value
        required: true
        schema:
          type: string
        style: form
      - description: "Maximum number of results to return (1-1000). Default: 100.\
          \ Note: Pagination is not currently supported - use smaller limits for faster\
          \ responses."
        example: 100
        explode: true
        in: query
        name: limit
        required: false
        schema:
          maximum: 1000
          minimum: 1
          type: string
        style: form
      responses:
        "200":
          content:
            application/json: {}
          description: Successfully retrieved search results.
        "400":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Invalid search field or parameters.
        "401":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Authentication failed. Missing or invalid API key.
        "429":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Rate limit exceeded for search operations.
      security:
      - bearerAuth: []
      summary: Search Geolocation Database by Field
      tags:
      - Location
      x-accepts:
      - application/json
  /v1/location/network:
    get:
      description: |
        <p>Returns geolocation and network information for an entire network range specified in CIDR notation. Useful for analyzing network blocks, ranges, and subnets.</p>
        <h4>Supported Formats:</h4>
        <ul>
            <li><b>IPv4 CIDR:</b> 192.168.1.0/24</li>
            <li><b>IPv6 CIDR:</b> 2001:db8::/32</li>
        </ul>
        <h4>Data Included:</h4>
        <ul>
            <li><b>Network Details:</b> CIDR range, first/last IP, total addresses</li>
            <li><b>Geographic:</b> Country, city, region for the network block</li>
            <li><b>Network:</b> ASN, organization, ISP information</li>
            <li><b>Classification:</b> Network type and usage category</li>
        </ul>
        <h4>Use Cases:</h4>
        <ul>
            <li>Analyzing suspicious network ranges</li>
            <li>Bulk geolocation for network blocks</li>
            <li>Infrastructure mapping and reconnaissance</li>
        </ul>
      operationId: getNetworkLocation
      parameters:
      - description: "The network range in CIDR notation (e.g., 8.8.8.0/24 or 2001:db8::/32)."
        example: 8.8.8.0/24
        explode: true
        in: query
        name: cidr
        required: true
        schema:
          type: string
        style: form
      responses:
        "200":
          content:
            application/json: {}
          description: Successfully retrieved network geolocation data.
        "400":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Invalid CIDR format or network specification.
        "401":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Authentication failed. Missing or invalid API key.
        "404":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Network not found in geolocation database.
      security:
      - bearerAuth: []
      summary: Get Network/CIDR Geolocation Data
      tags:
      - Location
      x-accepts:
      - application/json
  /v1/location/ip/{ip}:
    get:
      description: |
        <p>Returns comprehensive geolocation and network information for any IPv4 address. This is one of the fastest endpoints in the API, optimized for real-time fraud detection and access control.</p>
        <p><b>Note:</b> IPv6 addresses are not currently supported. Please use IPv4 addresses only.</p>
        <h4>Data Included:</h4>
        <ul>
            <li><b>Geographic:</b> Country, city, region, postal code, coordinates, timezone</li>
            <li><b>Network:</b> ASN, ISP/organization name, network range</li>
            <li><b>Classification:</b> Connection type (residential, datacenter, VPN, proxy, hosting)</li>
            <li><b>Reputation:</b> Risk indicators and abuse scores</li>
        </ul>
        <h4>Performance:</h4>
        <ul>
            <li><b>Response Time:</b> Typically &lt;150ms</li>
            <li><b>Cache:</b> Results cached for 6 hours by default</li>
        </ul>
        <h4>Use Cases:</h4>
        <ul>
            <li>Real-time fraud detection in payment flows</li>
            <li>Geographic access control and compliance</li>
            <li>Bot and VPN detection</li>
            <li>Threat intelligence enrichment</li>
        </ul>
      operationId: getIpLocation
      parameters:
      - description: The IPv4 address to lookup. IPv6 is not currently supported.
        example: 8.8.8.8
        explode: false
        in: path
        name: ip
        required: true
        schema:
          type: string
        style: simple
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/IpGeolocationResponse"
          description: Successfully retrieved geolocation data.
        "400":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Invalid IP address format. The provided value is not a valid
            IPv4 or IPv6 address.
        "401":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Authentication failed. Missing or invalid API key.
        "404":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: IP address not found in geolocation database. This may occur
            for reserved or private IP ranges.
        "429":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Rate limit exceeded. Standard limit is 100 requests per minute.
      security:
      - bearerAuth: []
      summary: Get IP Geolocation and ASN Data
      tags:
      - Location
      x-accepts:
      - application/json
  /v1/indicators/{type}/{value}:
    get:
      description: |
        <p>Retrieves comprehensive intelligence for a single IP address or domain. This is the primary, high-performance endpoint for synchronous enrichment.</p>
        <p>It aggregates data from multiple sources, including geolocation, WHOIS, DNS, reputation scoring, and relationship mapping. Use the `include` parameter to request additional, deeper data sets that may have higher latency.</p>
        <h4>Performance:</h4>
        <ul>
            <li><b>Base Response:</b> Typically under 500ms.</li>
            <li><b>With `include=routing`:</b> First request may take up to 5 seconds; subsequent requests are cached for 5 minutes and respond in &lt;200ms.</li>
            <li><b>With `include=ip_intelligence`:</b> Adds 200-500ms of latency for each IP address resolved from the domain.</li>
        </ul>
      operationId: getIndicator
      parameters:
      - description: The type of indicator to enrich.
        example: ip
        explode: false
        in: path
        name: type
        required: true
        schema:
          enum:
          - ip
          - domain
          type: string
        style: simple
      - description: "The value of the indicator (e.g., an IPv4/IPv6 address or a\
          \ domain name)."
        example: 8.8.8.8
        explode: false
        in: path
        name: value
        required: true
        schema:
          type: string
        style: simple
      - description: "A comma-separated list of additional data modules to include\
          \ in the response. Note: WHOIS and DNS data are included by default for\
          \ domains. Requesting more modules may increase latency."
        example: "routing,rpki"
        explode: true
        in: query
        name: include
        required: false
        schema:
          description: "Comma-separated values from: routing, rpki, ip_intelligence"
          enum:
          - routing
          - rpki
          - ip_intelligence
          type: string
        style: form
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/IndicatorResponse"
          description: Successfully retrieved intelligence data.
        "400":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Invalid indicator format or unsupported type.
        "401":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Authentication failed. Missing or invalid API key.
        "404":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: The requested indicator was not found in our datasets.
        "429":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Rate limit exceeded.
      security:
      - bearerAuth: []
      summary: Enrich a Single Indicator (IP or Domain)
      tags:
      - Enrichment
      x-accepts:
      - application/json
  /v1/indicators/{type}/{value}/predictive-risk:
    get:
      description: |
        <p>Returns ML-based predictive risk assessment for an IP address or domain. Provides current risk scoring,
        7-day and 30-day predictions, risk trajectory analysis, and contributing factors.</p>
        <h4>Response Includes:</h4>
        <ul>
            <li><b>Current Assessment:</b> Risk score (0-100), risk level, and confidence</li>
            <li><b>Predictions:</b> 7-day and 30-day risk forecasts with confidence intervals</li>
            <li><b>Trajectory:</b> Trend direction (improving/stable/worsening), velocity, stability</li>
            <li><b>Risk Factors:</b> Contributing factors with weights and descriptions</li>
            <li><b>Early Warnings:</b> Signals indicating potential future risk changes</li>
            <li><b>Similar Cases:</b> Historical indicators with similar profiles and their outcomes</li>
        </ul>
        <h4>Risk Levels:</h4>
        <ul>
            <li><b>low:</b> Score 0-30 - Minimal observed risk</li>
            <li><b>medium:</b> Score 31-60 - Moderate risk, warrants monitoring</li>
            <li><b>high:</b> Score 61-80 - Elevated risk, investigation recommended</li>
            <li><b>critical:</b> Score 81-100 - Severe risk, immediate action advised</li>
        </ul>
        <h4>Performance:</h4>
        <p>Pre-computed ML predictions. Response time typically under 500ms with 15-minute cache.</p>
      operationId: getPredictiveRisk
      parameters:
      - description: Type of indicator
        example: ip
        explode: false
        in: path
        name: type
        required: true
        schema:
          enum:
          - ip
          - domain
          type: string
        style: simple
      - description: The indicator value (IP address or domain)
        example: 8.8.8.8
        explode: false
        in: path
        name: value
        required: true
        schema:
          type: string
        style: simple
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PredictiveRiskResponse"
          description: Successfully retrieved predictive risk assessment.
        "400":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Invalid indicator type or value.
        "401":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Authentication failed. Missing or invalid API key.
        "404":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Indicator not found in AI model data.
      security:
      - bearerAuth: []
      summary: Get AI Predictive Risk Score
      tags:
      - Enrichment
      x-accepts:
      - application/json
  /v1/indicators/{type}/{value}/history:
    get:
      description: |
        <p>Retrieves time-series historical data for an IP address or domain. Track how infrastructure changes over time for threat intelligence and forensic analysis.</p>
        <h4>History Types:</h4>
        <ul>
            <li><b>whois:</b> Registration history - registrant changes, expiration updates, transfers</li>
            <li><b>routing:</b> BGP routing history - prefix announcements, ASN changes, route hijacks</li>
            <li><b>dns:</b> DNS resolution history - IP address changes, nameserver updates</li>
            <li><b>ssl:</b> Certificate history - cert replacements, CA changes, expiration events</li>
            <li><b>reputation:</b> Risk score history - blacklist appearances, reputation changes</li>
        </ul>
        <h4>Data Format:</h4>
        <p>Timeline with dated snapshots showing what changed and when:</p>
        <pre><code>{
          "history": [
            {
              "timestamp": "2025-01-15T10:00:00Z",
              "field": "registrant_company",
              "old_value": "Evil Corp",
              "new_value": "Legitimate LLC"
            }
          ]
        }</code></pre>
        <h4>Use Cases:</h4>
        <ul>
            <li>Tracking domain ownership changes</li>
            <li>Investigating IP reputation degradation</li>
            <li>Forensic timeline reconstruction</li>
            <li>Detecting infrastructure pivots by threat actors</li>
        </ul>
      operationId: getIndicatorHistory
      parameters:
      - description: Type of indicator
        example: domain
        explode: false
        in: path
        name: type
        required: true
        schema:
          enum:
          - ip
          - domain
          type: string
        style: simple
      - description: The indicator value (IP address or domain)
        example: example.com
        explode: false
        in: path
        name: value
        required: true
        schema:
          type: string
        style: simple
      - description: Type of historical data to retrieve
        example: whois
        explode: true
        in: query
        name: historyType
        required: false
        schema:
          enum:
          - whois
          - routing
          - dns
          - ssl
          - reputation
          type: string
        style: form
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/HistoryResponse"
          description: Successfully retrieved historical data.
        "400":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Invalid indicator type or history type.
        "401":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Authentication failed. Missing or invalid API key.
        "404":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: No historical data found for this indicator.
      security:
      - bearerAuth: []
      summary: Get Historical Data for Indicator
      tags:
      - Enrichment
      x-accepts:
      - application/json
  /v1/indicators/{type}/{value}/graph:
    get:
      description: |
        <p>Returns graph visualization data showing relationships between the indicator and related infrastructure. Perfect for interactive network diagrams and threat actor infrastructure mapping.</p>
        <h4>Relationship Types Included:</h4>
        <ul>
            <li><b>For Domains:</b>
                <ul>
                    <li>Resolves to IPs</li>
                    <li>Shares nameservers with</li>
                    <li>Same SSL certificate as</li>
                    <li>Same registrant as</li>
                    <li>Links to/from other domains</li>
                </ul>
            </li>
            <li><b>For IPs:</b>
                <ul>
                    <li>Hosts domains</li>
                    <li>Same ASN as</li>
                    <li>Same network block as</li>
                    <li>Connected via routing</li>
                </ul>
            </li>
        </ul>
        <h4>Output Format:</h4>
        <p>Compatible with react-force-graph, vis.js, cytoscape.js:</p>
        <pre><code>{
          "nodes": [
            {"id": "example.com", "type": "domain", "label": "example.com"},
            {"id": "8.8.8.8", "type": "ip", "label": "8.8.8.8"}
          ],
          "links": [
            {"source": "example.com", "target": "8.8.8.8", "type": "resolves_to"}
          ]
        }</code></pre>
        <h4>Performance:</h4>
        <ul>
            <li>Response Time: 500ms-2s depending on graph complexity</li>
            <li>Default: 100 nodes maximum (adjustable)</li>
        </ul>
        <h4>Use Cases:</h4>
        <ul>
            <li>Interactive threat actor infrastructure visualization</li>
            <li>Discovering related phishing campaigns</li>
            <li>Mapping shadow IT and sprawl</li>
            <li>Network topology visualization</li>
        </ul>
      operationId: getIndicatorGraph
      parameters:
      - description: Type of indicator
        example: domain
        explode: false
        in: path
        name: type
        required: true
        schema:
          enum:
          - ip
          - domain
          type: string
        style: simple
      - description: The indicator value (IP address or domain)
        example: example.com
        explode: false
        in: path
        name: value
        required: true
        schema:
          type: string
        style: simple
      - description: Maximum number of nodes to return in the graph
        example: 100
        explode: true
        in: query
        name: limit
        required: false
        schema:
          default: 100
          format: int32
          type: integer
        style: form
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/GraphResponse"
          description: "Successfully retrieved graph data. Compatible with react-force-graph,\
            \ vis.js, and cytoscape.js."
        "400":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: "Invalid indicator type or limit parameter. Type must be 'ip'\
            \ or 'domain', limit must be 1-500."
        "401":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Authentication failed. Missing or invalid API key.
        "404":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Indicator not found or no relationships discovered.
      security:
      - bearerAuth: []
      summary: Get Infrastructure Relationship Graph
      tags:
      - Enrichment
      x-accepts:
      - application/json
  /v1/indicators/domain/{domain}/subdomains:
    get:
      description: "Retrieves a list of discovered subdomains for a given root domain,\
        \ based on passive DNS and other enumeration techniques."
      operationId: getSubdomains
      parameters:
      - description: The root domain to query for subdomains.
        example: google.com
        explode: false
        in: path
        name: domain
        required: true
        schema:
          type: string
        style: simple
      - description: The maximum number of subdomains to return.
        example: 100
        explode: true
        in: query
        name: limit
        required: false
        schema:
          default: 100
          format: int32
          type: integer
        style: form
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/SubdomainResponse"
          description: Successfully retrieved subdomains.
        "400":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Invalid domain format.
        "401":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Authentication failed. Missing or invalid API key.
        "404":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Domain not found or no subdomains discovered.
      security:
      - bearerAuth: []
      summary: Get Domain Subdomains
      tags:
      - Enrichment
      x-accepts:
      - application/json
  /v1/ops/screenshots/schedules/{scheduleId}/history:
    delete:
      description: |
        <p>Delete all captured screenshots for a schedule while keeping the schedule active.</p>
        <p><b>Warning:</b> This action cannot be undone. All screenshots will be permanently deleted.</p>
      operationId: clearScreenshotHistory
      parameters:
      - description: The schedule ID
        example: sched_abc123
        explode: false
        in: path
        name: scheduleId
        required: true
        schema:
          type: string
        style: simple
      responses:
        "200":
          content:
            '*/*':
              schema:
                type: object
          description: Screenshot history successfully cleared.
        "404":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Schedule not found or does not belong to your API key.
      security:
      - bearerAuth: []
      summary: Clear Screenshot History
      tags:
      - Screenshots
      x-accepts:
      - '*/*'
      - application/json
components:
  responses:
    TooManyRequests:
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/RateLimitError"
      description: Rate limit exceeded. The response includes a `Retry-After` header
        indicating when you can retry.
  schemas:
    RateLimitError:
      description: Rate limit exceeded error response
      properties:
        error:
          description: Error type
          example: Too Many Requests
          type: string
        message:
          description: Human-readable error message with rate limit category
          example: Rate limit exceeded for indicators. Please retry after 1 seconds.
          type: string
        retryAfter:
          description: Number of seconds to wait before retrying
          example: 1
          format: int32
          type: integer
      required:
      - error
      - message
      - retryAfter
    MonitorAssertions:
      description: Assertions to validate check results
      example:
        headers:
          key: headers
        dnsRecordValue: 93.184.216.34
        containsText: status
        notContainsText: error
        maxResponseTime: 3000
        sslDaysUntilExpiry: 30
        dnsRecordType: A
        statusCode: 200
      properties:
        headers:
          additionalProperties:
            type: string
          description: Expected response headers
        statusCode:
          description: Expected HTTP status code
          example: 200
          format: int32
          type: integer
        maxResponseTime:
          description: Maximum response time in milliseconds
          example: 3000
          format: int64
          type: integer
        containsText:
          description: Text that must be present in response body
          example: status
          type: string
        notContainsText:
          description: Text that must NOT be present in response body
          example: error
          type: string
        sslDaysUntilExpiry:
          description: Minimum SSL certificate days until expiry (for ssl checks)
          example: 30
          format: int32
          type: integer
        dnsRecordValue:
          description: Expected DNS record value (for dns checks)
          example: 93.184.216.34
          type: string
        dnsRecordType:
          description: DNS record type (for dns checks)
          enum:
          - A
          - AAAA
          - CNAME
          - MX
          - TXT
          - NS
          example: A
          type: string
    MonitorCheckRequest:
      description: Request to create or update a monitoring check
      example:
        headers:
          key: headers
        method: GET
        name: My Website Health
        locations:
        - us-east-1
        - eu-west-1
        assertions:
          headers:
            key: headers
          dnsRecordValue: 93.184.216.34
          containsText: status
          notContainsText: error
          maxResponseTime: 3000
          sslDaysUntilExpiry: 30
          dnsRecordType: A
          statusCode: 200
        type: api
        body: body
        url: https://example.com/health
        enabled: true
        frequency: 10
      properties:
        name:
          description: Name of the monitoring check
          example: My Website Health
          minLength: 1
          type: string
        url:
          description: URL to monitor
          example: https://example.com/health
          minLength: 1
          pattern: ^https?://.*
          type: string
        type:
          description: "Type of check: api, ssl, or dns"
          enum:
          - api
          - ssl
          - dns
          example: api
          pattern: ^(api|ssl|dns)$
          type: string
        frequency:
          description: Check frequency in minutes
          example: 10
          format: int32
          maximum: 1440
          minimum: 1
          type: integer
        locations:
          description: Locations to run checks from
          example:
          - us-east-1
          - eu-west-1
          items:
            type: string
          type: array
        assertions:
          $ref: "#/components/schemas/MonitorAssertions"
        enabled:
          description: Whether the check is enabled
          example: true
          type: boolean
        method:
          description: HTTP method for API checks
          enum:
          - GET
          - POST
          - PUT
          - DELETE
          - HEAD
          - OPTIONS
          example: GET
          pattern: ^(GET|POST|PUT|DELETE|HEAD|OPTIONS)$
          type: string
        headers:
          additionalProperties:
            type: string
          description: Request headers for API checks
        body:
          description: Request body for POST/PUT API checks
          type: string
      required:
      - name
      - url
    MonitorCheckResponse:
      description: Monitoring check details
      example:
        lastRunAt: 2000-01-23T04:56:07.000+00:00
        method: GET
        uptime30Days: 99.92
        responseTime: 245
        uptime7Days: 99.87
        type: api
        url: https://example.com/health
        enabled: true
        frequency: 10
        createdAt: 2000-01-23T04:56:07.000+00:00
        uptime24Hours: 99.95
        name: My Website Health
        locations:
        - us-east-1
        - eu-west-1
        id: abc123
        assertions:
          headers:
            key: headers
          dnsRecordValue: 93.184.216.34
          containsText: status
          notContainsText: error
          maxResponseTime: 3000
          sslDaysUntilExpiry: 30
          dnsRecordType: A
          statusCode: 200
        muted: false
        status: passing
        updatedAt: 2000-01-23T04:56:07.000+00:00
      properties:
        id:
          description: Unique identifier for the check
          example: abc123
          type: string
        name:
          description: Name of the monitoring check
          example: My Website Health
          type: string
        url:
          description: URL being monitored
          example: https://example.com/health
          type: string
        type:
          description: Type of check
          enum:
          - api
          - ssl
          - dns
          example: api
          type: string
        status:
          description: Current status
          enum:
          - passing
          - failing
          - degraded
          - pending
          example: passing
          type: string
        enabled:
          description: Whether the check is enabled
          example: true
          type: boolean
        frequency:
          description: Check frequency in minutes
          example: 10
          format: int32
          type: integer
        locations:
          description: Locations where check runs
          example:
          - us-east-1
          - eu-west-1
          items:
            type: string
          type: array
        muted:
          description: Whether the check is muted (no alerts)
          example: false
          type: boolean
        method:
          description: HTTP method used for API checks
          example: GET
          type: string
        assertions:
          $ref: "#/components/schemas/MonitorAssertions"
        lastRunAt:
          description: Last time the check ran
          format: date-time
          type: string
        createdAt:
          description: When the check was created
          format: date-time
          type: string
        updatedAt:
          description: When the check was last updated
          format: date-time
          type: string
        uptime24Hours:
          description: Uptime percentage over the last 24 hours
          example: 99.95
          format: double
          type: number
        uptime7Days:
          description: Uptime percentage over the last 7 days
          example: 99.87
          format: double
          type: number
        uptime30Days:
          description: Uptime percentage over the last 30 days
          example: 99.92
          format: double
          type: number
        responseTime:
          description: Average response time in milliseconds
          example: 245
          format: int64
          type: integer
    ErrorResponse:
      description: Standard error response returned when an API request fails
      example:
        path: /v1/indicators/ip/invalid-ip
        trace_id: 550e8400-e29b-41d4-a716-446655440000
        details: ""
        error: INVALID_INDICATOR
        message: The provided IP address is not a valid IPv4 or IPv6 address
        status: 400
        timestamp: 2024-12-20T10:15:30.123Z
      properties:
        status:
          description: The HTTP status code of the error
          example: 400
          format: int32
          type: integer
        error:
          description: "A short, machine-readable error code"
          example: INVALID_INDICATOR
          type: string
        message:
          description: A human-readable error message providing more detail
          example: The provided IP address is not a valid IPv4 or IPv6 address
          type: string
        details: {}
        timestamp:
          description: The timestamp when the error occurred
          example: 2024-12-20T10:15:30.123Z
          format: date-time
          type: string
        trace_id:
          description: "A unique trace ID for this request, useful for debugging"
          example: 550e8400-e29b-41d4-a716-446655440000
          type: string
        path:
          description: The API path that generated this error
          example: /v1/indicators/ip/invalid-ip
          type: string
      required:
      - error
      - message
      - status
      - timestamp
    ChangeTrackingRequest:
      description: Request to start or update change tracking for an indicator
      example:
        fields:
        - dns
        - whois
        - ssl
        enabled: true
        frequency: daily
      properties:
        fields:
          description: Fields to track for changes. Valid values depend on indicator
            type.
          example:
          - dns
          - whois
          - ssl
          items:
            type: string
          type: array
        frequency:
          description: How often to check for changes
          enum:
          - hourly
          - daily
          - weekly
          example: daily
          pattern: ^(hourly|daily|weekly)$
          type: string
        enabled:
          description: Whether tracking is enabled
          example: true
          type: boolean
    JobResponse:
      description: Response returned when an asynchronous job is created. Contains
        the job ID and status URL for polling.
      example:
        jobId: 550e8400-e29b-41d4-a716-446655440000
        status: PENDING
        statusUrl: /v1/ops/jobs/550e8400-e29b-41d4-a716-446655440000
        message: Job accepted for processing
      properties:
        jobId:
          description: Unique identifier for the job. Use this ID to poll for job
            status and results.
          example: 550e8400-e29b-41d4-a716-446655440000
          type: string
        status:
          description: Current status of the job
          enum:
          - PENDING
          - RUNNING
          - COMPLETED
          - FAILED
          - CANCELLED
          example: PENDING
          type: string
        statusUrl:
          description: "URL endpoint to poll for job status and results. Typically\
            \ `/v1/ops/jobs/{jobId}`."
          example: /v1/ops/jobs/550e8400-e29b-41d4-a716-446655440000
          type: string
        message:
          description: Human-readable message describing the job acceptance or current
            state
          example: Job accepted for processing
          type: string
      required:
      - jobId
      - status
      - statusUrl
    GenericSuccessResponse:
      description: Generic success response for operations that don't return specific
        data
      example:
        deleted: true
        id: sched_abc123
        message: Monitoring check triggered
        cleared: true
        schedule_id: sched_abc123
        status: triggered
      properties:
        status:
          description: Status of the operation
          enum:
          - triggered
          - deleted
          - cleared
          - success
          example: triggered
          type: string
        message:
          description: Human-readable message describing the operation result
          example: Monitoring check triggered
          type: string
        id:
          description: ID of the related resource (if applicable)
          example: sched_abc123
          type: string
        deleted:
          description: Whether the operation was successful (for delete operations)
          example: true
          type: boolean
        cleared:
          description: Whether the operation was successful (for clear operations)
          example: true
          type: boolean
        schedule_id:
          description: Schedule ID (for schedule-related operations)
          example: sched_abc123
          type: string
    ScreenshotOptions:
      description: "Configuration options for screenshot capture including viewport\
        \ size, format, and behavior settings."
      example:
        width: 1920
        height: 1080
        full_page: false
        wait_time: 2000
        format: png
        quality: 90
        javascript: true
        block_ads: false
      properties:
        width:
          default: 1920
          description: Viewport width in pixels
          example: 1920
          format: int32
          maximum: 7680
          minimum: 320
          type: integer
        height:
          default: 1080
          description: Viewport height in pixels
          example: 1080
          format: int32
          maximum: 4320
          minimum: 240
          type: integer
        full_page:
          default: false
          description: Capture the full page height (scrolling screenshot)
          example: false
          type: boolean
        wait_time:
          default: 2000
          description: Wait time in milliseconds before taking screenshot
          example: 2000
          format: int32
          maximum: 30000
          minimum: 0
          type: integer
        format:
          default: png
          description: Image format for the screenshot
          enum:
          - png
          - jpeg
          - webp
          example: png
          pattern: ^(png|jpeg|webp)$
          type: string
        quality:
          default: 90
          description: "Image quality (1-100, only for jpeg/webp)"
          example: 90
          format: int32
          maximum: 100
          minimum: 1
          type: integer
        user_agent:
          description: User agent string to use for the request
          example: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36
          type: string
        javascript:
          default: true
          description: Enable JavaScript execution
          example: true
          type: boolean
        block_ads:
          default: false
          description: Block ads and trackers
          example: true
          type: boolean
        accept_cookies:
          default: true
          description: Accept cookies consent if prompted
          example: true
          type: boolean
    ScreenshotRequest:
      description: Request parameters for capturing a website screenshot
      example:
        schedule:
          frequency: daily
          timezone: UTC
          retention_count: 30
          enabled: true
        options:
          width: 1920
          height: 1080
          full_page: false
          wait_time: 2000
          format: png
          quality: 90
          javascript: true
          block_ads: false
        url: https://example.com
      properties:
        url:
          description: The URL of the website to capture
          example: https://example.com
          minLength: 1
          pattern: ^https?://.*
          type: string
        options:
          $ref: "#/components/schemas/ScreenshotOptions"
        schedule:
          $ref: "#/components/schemas/ScreenshotScheduleConfig"
      required:
      - url
    ScreenshotScheduleConfig:
      description: Configuration for scheduling recurring screenshot captures.
      example:
        frequency: daily
        timezone: UTC
        retention_count: 30
        enabled: true
      properties:
        cron:
          description: Cron expression for scheduling (advanced). Use frequency for
            simpler configuration.
          example: 0
          pattern: Cron expression
          type: string
        frequency:
          description: Frequency of captures. Use one of the preset values or provide
            a cron expression for custom schedules.
          enum:
          - hourly
          - every_6_hours
          - every_12_hours
          - twice_daily
          - daily
          - weekly
          - monthly
          example: daily
          type: string
        timezone:
          default: UTC
          description: Timezone for scheduled captures
          example: UTC
          type: string
        retention_count:
          default: 30
          description: Maximum number of captures to retain
          example: 30
          format: int32
          maximum: 1000
          minimum: 1
          type: integer
        enabled:
          default: true
          description: Enable/disable the schedule
          example: true
          type: boolean
    JsonNode: {}
    InfrastructureMapRequest:
      description: Configuration for mapping infrastructure relationships and discovering
        connected assets
      example:
        depth: 2
        startPoint: example.com
      properties:
        startPoint:
          description: Starting point for infrastructure mapping (domain or IP address)
          example: example.com
          minLength: 1
          type: string
        depth:
          default: 1
          description: "Depth of relationship mapping (number of hops from starting\
            \ point). Depth 1: Direct relationships (~30s, 10-50 assets), Depth 2:\
            \ 2 hops (~2-5 min, 50-500 assets), Depth 3: 3 hops (~10-30 min, 500-5000\
            \ assets)"
          example: 2
          format: int32
          maximum: 3
          minimum: 1
          type: integer
      required:
      - startPoint
    ScanRequest:
      description: Request for initiating a domain infrastructure scan
      example:
        domain: example.com
        type: comprehensive
      properties:
        domain:
          description: The target domain to scan
          example: example.com
          minLength: 1
          type: string
        type:
          default: comprehensive
          description: Type of scan to perform. Determines which scanning module to
            use.
          enum:
          - comprehensive
          - subdomains
          - ssl
          - dns
          - technologies
          - whois
          - vulnerability
          example: comprehensive
          pattern: ^(comprehensive|subdomains|ssl|dns|technologies|whois|vulnerability)$
          type: string
      required:
      - domain
    MonitoringAlertRequest:
      description: Configuration for creating monitoring alert rules with notification
        channels
      example:
        slack_webhook: https://hooks.slack.com/services/T00000000/B00000000/XXXXXXXXXXXXXXXXXXXX
        channels:
        - email
        - slack
        webhook_url: https://api.example.com/webhook/alerts
        threshold_days: 14
        pagerduty_key: R03XXXXXXXXXXXXXXXXXXXXXX
        type: ssl_expiring
        email: alerts@example.com
      properties:
        type:
          description: Type of alert condition to monitor
          enum:
          - downtime
          - dns_change
          - whois_change
          - ssl_expiring
          - content_change
          - technology_change
          example: ssl_expiring
          minLength: 1
          pattern: ^(downtime|dns_change|whois_change|ssl_expiring|content_change|technology_change)$
          type: string
        threshold_days:
          description: Threshold in days (for ssl_expiring alerts). Alert triggers
            when SSL cert expires within this many days.
          example: 14
          format: int32
          minimum: 1
          type: integer
        channels:
          description: Notification channels to use for alerts
          example:
          - email
          - slack
          items:
            type: string
          type: array
          uniqueItems: true
        email:
          description: Email address for alert notifications
          example: alerts@example.com
          format: email
          type: string
        slack_webhook:
          description: Slack webhook URL for notifications
          example: https://hooks.slack.com/services/T00000000/B00000000/XXXXXXXXXXXXXXXXXXXX
          type: string
        webhook_url:
          description: Custom webhook URL for notifications (will receive POST with
            alert data)
          example: https://api.example.com/webhook/alerts
          type: string
        pagerduty_key:
          description: PagerDuty integration key for incident creation
          example: R03XXXXXXXXXXXXXXXXXXXXXX
          type: string
      required:
      - type
    GraphQLRequest:
      description: |
        Request to execute a GraphQL query against the graph database.

        Follows the standard GraphQL over HTTP specification.

        **Available Query Operations:**
        - `domain(name: String!)` - Look up domain information
        - `ipv4(address: String!)` - Look up IPv4 address information
        - `ipv6(address: String!)` - Look up IPv6 address information
        - `asn(number: Int!)` - Look up ASN information
        - `searchDomains(pattern: String!, limit: Int)` - Search domains by pattern
        - `domainsOnIP(address: String!)` - Find domains on an IP
        - `domainsOnASN(asnNumber: Int!, limit: Int)` - Find domains on an ASN
        - `checkIndicator(indicator: String!)` - Check if indicator is listed

        **Example Query:**
        ```graphql
        query GetDomainInfo($domain: String!) {
          domain(name: $domain) {
            name
            ipAddresses {
              address
              country { code }
            }
            nameservers { name }
            asns { number }
          }
        }
        ```
      example:
        variables:
          domain: google.com
          limit: 10
        query: "{ domain(name: \"google.com\") { name ipAddresses { address } nameservers\
          \ { name } } }"
        operationName: GetDomainInfo
      properties:
        query:
          description: The GraphQL query or mutation to execute
          example: "{ domain(name: \"google.com\") { name ipAddresses { address }\
            \ nameservers { name } } }"
          minLength: 1
          type: string
        operationName:
          description: Name of the operation to execute (for documents with multiple
            operations)
          example: GetDomainInfo
          type: string
        variables:
          additionalProperties: {}
          description: Variables to pass to the query as key-value pairs
          example:
            domain: google.com
            limit: 10
      required:
      - query
    CypherQueryRequest:
      description: |
        Request to execute a read-only Cypher query against the FalkorDB graph database.

        **Security Note:** Only read operations (MATCH, RETURN) are allowed.
        Write operations (CREATE, DELETE, SET, MERGE) are blocked by the backend.

        **Example Queries:**
        - Find domain IPs: `MATCH (d:DomainName {name: $domain})-[:hasIP]->(ip:A_ADDRESS) RETURN ip.name`
        - Get ASN info: `MATCH (asn:ASN {number: $asn})-[:announces]->(p:ANNOUNCED_PREFIX_4) RETURN p`
        - Find blacklisted IPs: `MATCH (ip:A_ADDRESS)-[:isListed]->(l:LIST) RETURN ip.name, l.name LIMIT 10`
      example:
        query: "MATCH (d:DomainName {name: $domain})-[:hasIP]->(ip:A_ADDRESS) RETURN\
          \ ip.name AS ip"
        limit: 100
        parameters:
          domain: google.com
      properties:
        query:
          description: |
            The Cypher query to execute. Must be a read-only query (MATCH/RETURN).

            Use `$paramName` syntax to reference parameters from the `parameters` map.
          example: "MATCH (d:DomainName {name: $domain})-[:hasIP]->(ip:A_ADDRESS)\
            \ RETURN ip.name AS ip"
          minLength: 1
          type: string
        parameters:
          additionalProperties: {}
          description: |
            Query parameters as key-value pairs. Use `$key` in the query to reference these.

            Supported value types: String, Number, Boolean, List, Map.
          example:
            domain: google.com
        limit:
          default: 100
          description: Maximum number of results to return. Overrides any LIMIT clause
            in the query.
          example: 100
          format: int32
          maximum: 1000
          minimum: 1
          type: integer
      required:
      - query
    CypherQueryResponse:
      description: |
        Response from executing a Cypher query against the graph database.

        Contains the query results as a list of records, along with execution metadata
        including timing and column information.
      example:
        columns:
        - ip
        - country
        executionTimeMs: 45
        truncated: false
        rowCount: 2
        error: error
        results:
        - ip: 8.8.8.8
          country: US
        - ip: 8.8.4.4
          country: US
      properties:
        results:
          description: Query results as a list of records. Each record is a map of
            column name to value.
          example:
          - ip: 8.8.8.8
            country: US
          - ip: 8.8.4.4
            country: US
          items:
            additionalProperties: {}
          type: array
        executionTimeMs:
          description: Query execution time in milliseconds
          example: 45
          format: int64
          type: integer
        rowCount:
          description: Number of rows returned
          example: 2
          format: int32
          type: integer
        columns:
          description: Column names in the result set
          example:
          - ip
          - country
          items:
            type: string
          type: array
        truncated:
          description: Whether the result was truncated due to limit
          example: false
          type: boolean
        error:
          description: Error message if the query failed
          type: string
          example: null
    SimilarDomainsOpsRequest:
      description: Request for generating similar/lookalike domains for brand protection
      example:
        techniques:
        - typosquatting
        - homoglyph
        - tld_variation
        domain: example.com
        limit: 100
        options: ""
      properties:
        domain:
          description: The target domain to generate variations for
          example: example.com
          minLength: 1
          type: string
        techniques:
          description: "Techniques to use for generating similar domains. Supported\
            \ values: typosquatting, homoglyph, bitsquatting, tld_variation, sounding,\
            \ prefix, suffix, contains, levenshtein. If not specified, defaults to\
            \ typosquatting."
          example:
          - typosquatting
          - homoglyph
          - tld_variation
          type: string
        limit:
          description: Maximum number of similar domains to return per technique
          example: 100
          format: int32
          type: integer
        options: {}
      required:
      - domain
    AnalysisMetadata:
      description: Metadata about the similarity search that was performed
      properties:
        techniquesUsed:
          description: Comma-separated list of backend similarity types that were
            used
          example: "TYPO,UTFVARS"
          type: string
        baseDomain:
          description: The base domain that was searched
          example: google.com
          type: string
        searchLimit:
          description: The limit that was applied to the search
          example: 100
          format: int32
          type: integer
      required:
      - baseDomain
      - searchLimit
      - techniquesUsed
    SimilarDomainEntry:
      description: A single similar domain entry with its detection technique
      properties:
        domain:
          description: "The similar domain name. For homoglyph/IDN domains, may include\
            \ punycode in parentheses."
          example: gooogle.com
          type: string
        technique:
          description: The similarity detection technique that found this domain
          enum:
          - TYPO
          - UTFVARS
          - TLD_VARIANTS
          - SOUNDING
          - PREFIX
          - SUFFIX
          - CONTAINS
          - LEVENSHTEIN
          example: TYPO
          type: string
      required:
      - domain
      - technique
    SimilarDomainsResponse:
      description: "Result returned when a similar domains job completes. Access this\
        \ via GET /v1/ops/jobs/{jobId} after the job status becomes COMPLETED."
      example:
        domain: google.com
        status: completed
        similarDomains:
        - domain: gooogle.com
          technique: TYPO
        - domain: googel.com
          technique: TYPO
        - domain: gооgle.com (xn--ggle-0nd57e.com)
          technique: UTFVARS
        totalCount: 3
        analysis:
          techniquesUsed: "TYPO,UTFVARS"
          baseDomain: google.com
          searchLimit: 100
      properties:
        domain:
          description: The input domain that was analyzed
          example: google.com
          type: string
        status:
          description: Job completion status
          enum:
          - completed
          - failed
          example: completed
          type: string
        similarDomains:
          description: List of similar domains found
          items:
            $ref: "#/components/schemas/SimilarDomainEntry"
          type: array
        totalCount:
          description: Total number of similar domains found
          example: 150
          format: int32
          type: integer
        analysis:
          $ref: "#/components/schemas/AnalysisMetadata"
        error:
          description: "Error flag, present only when status is 'failed'"
          example: true
          type: boolean
        message:
          description: "Error message, present only when status is 'failed'"
          example: "Failed to generate similar domains: Connection timeout"
          type: string
      required:
      - analysis
      - domain
      - similarDomains
      - status
      - totalCount
    SearchRequest:
      description: |
        Search query for finding domains matching WHOIS registration criteria.

        **Query Modes:**
        1. **Field-based (recommended):** Specify individual fields like `registrantCompany`, `tld`, etc.
        2. **Query string:** Use `query` field with `field:value` syntax for compatibility.

        Multiple criteria are combined with AND logic. Results are paginated with a maximum of 100 results per page.

        **Use Cases:**
        - Threat hunting: Find domains registered by known malicious actors
        - Brand protection: Monitor for domains similar to your brand
        - Infrastructure discovery: Map domains sharing registrants or nameservers
        - Investigation: Track domains created on specific dates
      example:
        registrantCity: Mountain View
        offset: 0
        effectivePage: 0
        query: registrantCompany:Google
        registrarName: "GoDaddy.com, LLC"
        registrarIanaId: 146
        registrantEmail: admin@example.com
        domainStatus: clientTransferProhibited
        updatedDate: 2024-06-01
        tld: com
        registrantName: John Doe
        expiryDate: 2025-01-15
        registrantPhone: "+1.6502530000"
        createdDate: 2024-01-15
        field: registrantCompany
        registrantCompany: Google LLC
        nameServer: ns1.google.com
        limit: 100
        page: 0
        registrantCountry: US
      properties:
        effectivePage:
          format: int32
          type: integer
        query:
          description: |
            Search query using field:value syntax (alternative to individual field parameters).
            If individual field parameters are provided, they take precedence.

            **Supported Syntax:**
            - Single field: `registrantCompany:Google`
            - Multiple fields: `registrantCompany:Google registrantCountry:US`

            **Note:** For new integrations, prefer using individual field parameters instead of query syntax.
          example: registrantCompany:Google
          type: string
        field:
          description: Field to search in when using simple query mode. Use with `query`
            parameter.
          enum:
          - registrantName
          - registrantCompany
          - registrantEmail
          - registrantPhone
          - registrantCountry
          - registrantCity
          - nameServer
          - registrarName
          - registrarIanaId
          - tld
          - domainStatus
          - createdDate
          - updatedDate
          - expiryDate
          example: registrantCompany
          type: string
        tld:
          description: "Top-Level Domain to filter by (exact match). Examples: com,\
            \ org, net, io"
          example: com
          type: string
        registrarName:
          description: Domain registrar name to filter by (exact match)
          example: "GoDaddy.com, LLC"
          type: string
        registrarIanaId:
          description: IANA registrar ID to filter by (exact match)
          example: 146
          type: string
        registrantName:
          description: "Registrant name to search for (text search, partial match)"
          example: John Doe
          type: string
        registrantCompany:
          description: "Registrant company/organization to search for (text search,\
            \ partial match)"
          example: Google LLC
          type: string
        registrantEmail:
          description: Registrant email to search for (text search). Supports wildcards
            like *@example.com
          example: admin@example.com
          type: string
        registrantPhone:
          description: Registrant phone number to search for (text search)
          example: "+1.6502530000"
          type: string
        registrantCountry:
          description: Registrant country code to filter by (2-letter ISO code)
          example: US
          type: string
        registrantCity:
          description: Registrant city to search for (text search)
          example: Mountain View
          type: string
        nameServer:
          description: Name server hostname to search for (text search)
          example: ns1.google.com
          type: string
        domainStatus:
          description: "Domain status flag to search for (text search). E.g., clientTransferProhibited"
          example: clientTransferProhibited
          type: string
        createdDate:
          description: "Domain creation date to filter by (exact match, format: YYYY-MM-DD)"
          example: 2024-01-15
          pattern: "^\\d{4}-\\d{2}-\\d{2}$"
          type: string
        updatedDate:
          description: "Domain last update date to filter by (exact match, format:\
            \ YYYY-MM-DD)"
          example: 2024-06-01
          pattern: "^\\d{4}-\\d{2}-\\d{2}$"
          type: string
        expiryDate:
          description: "Domain expiry date to filter by (exact match, format: YYYY-MM-DD)"
          example: 2025-01-15
          pattern: "^\\d{4}-\\d{2}-\\d{2}$"
          type: string
        limit:
          default: 100
          description: Maximum number of results to return per page (max 100 for WHOIS
            searches)
          example: 100
          format: int32
          maximum: 100
          minimum: 1
          type: integer
        page:
          default: 0
          description: Page number for pagination (0-indexed). Alternative to offset.
          example: 0
          format: int32
          minimum: 0
          type: integer
        offset:
          default: 0
          description: Number of results to skip for pagination. Converted to page
            internally.
          example: 0
          format: int32
          minimum: 0
          type: integer
    DomainItem:
      description: A single domain entry in the search results
      properties:
        domain:
          description: The domain name
          example: google.com
          type: string
      required:
      - domain
    SearchResponse:
      description: "Result returned when a WHOIS search job completes. Access this\
        \ via GET /v1/ops/jobs/{jobId} after the job status becomes COMPLETED."
      example:
        source: whois
        queryType: registration_data
        items:
        - domain: google.com
        - domain: google.net
        - domain: google.org
        total: 144464
        pageNumber: 0
        pageSize: 100
        totalPages: 1445
      properties:
        source:
          description: The data source that was searched
          enum:
          - whois
          - domainer
          - geograph
          example: whois
          type: string
        queryType:
          description: The type of query that was performed
          enum:
          - registration_data
          - domain_search
          - location_search
          example: registration_data
          type: string
        items:
          description: List of matching domains
          items:
            $ref: "#/components/schemas/DomainItem"
          type: array
        total:
          description: Total number of matching records across all pages
          example: 144464
          format: int32
          type: integer
        pageNumber:
          description: Current page number (0-indexed)
          example: 0
          format: int32
          type: integer
        pageSize:
          description: Number of results per page
          example: 100
          format: int32
          type: integer
        totalPages:
          description: Total number of pages available
          example: 1445
          format: int32
          type: integer
        error:
          description: "Error flag, present only when the search failed"
          example: true
          type: boolean
        message:
          description: "Error message, present only when the search failed"
          example: "WHOIS search failed: Connection timeout"
          type: string
      required:
      - items
      - pageNumber
      - pageSize
      - queryType
      - source
      - total
      - totalPages
    BulkOptions:
      description: "Advanced configuration options for bulk processing including batch\
        \ size, timeouts, and error handling."
      example:
        parallel_processing: true
        batch_size: 10
        timeout_per_indicator: 30000
        continue_on_error: true
        include_failed: false
      properties:
        parallel_processing:
          default: true
          description: Enable parallel processing of indicators for faster results
          example: true
          type: boolean
        batch_size:
          default: 10
          description: Number of indicators to process in each batch. Smaller batches
            = more frequent progress updates
          example: 10
          format: int32
          maximum: 50
          minimum: 1
          type: integer
        timeout_per_indicator:
          default: 30000
          description: Maximum time in milliseconds to wait for each indicator before
            timing out. Domain enrichment and ip_intelligence require longer timeouts.
          example: 30000
          format: int32
          maximum: 120000
          minimum: 1000
          type: integer
        continue_on_error:
          default: true
          description: Continue processing remaining indicators if one fails. Recommended
            for large batches.
          example: true
          type: boolean
        include_failed:
          default: false
          description: Include failed indicators in the response with error details
          example: false
          type: boolean
    BulkRequest:
      description: Request payload for bulk enrichment of multiple IP addresses and
        domains
      example:
        include:
        - routing
        - routing
        options:
          parallel_processing: true
          batch_size: 10
          timeout_per_indicator: 30000
          continue_on_error: true
          include_failed: false
        indicators:
        - 8.8.8.8
        - 8.8.8.8
        - 8.8.8.8
        - 8.8.8.8
        - 8.8.8.8
      properties:
        indicators:
          description: List of indicators (IP addresses or domains) to enrich. Mix
            of IPs and domains is supported. The indicator type is auto-detected.
          items:
            description: IP address or domain name
            example: 8.8.8.8
            type: string
          maxItems: 100
          minItems: 0
          type: array
        include:
          description: |
            Additional data modules to include for each indicator. By default, base enrichment includes
            geolocation, ASN, reputation, and relationships. For domains, WHOIS (registration) and DNS
            data are included by default.

            <b>Available options:</b>
            <ul>
              <li><code>routing</code> - BGP routing data, prefix visibility, route origins (IPs only)</li>
              <li><code>rpki</code> - RPKI validation status (IPs only)</li>
              <li><code>historical</code> - Historical data for the indicator</li>
              <li><code>whois</code> - WHOIS registration data (domains only, included by default)</li>
              <li><code>dns</code> - DNS records (domains only, included by default)</li>
              <li><code>ip_intelligence</code> - Full IP enrichment for resolved domain IPs (domains only, significantly increases processing time)</li>
            </ul>

            Note: Adding more include options increases processing time per indicator.
          items:
            description: Include option
            enum:
            - routing
            - rpki
            - historical
            - whois
            - dns
            - ip_intelligence
            type: string
          type: array
          uniqueItems: true
        options:
          $ref: "#/components/schemas/BulkOptions"
      required:
      - indicators
    BulkEnrichmentResult:
      description: Result of a bulk indicator enrichment job. Contains enriched data
        for all successfully processed indicators.
      example:
        totalIndicators: 100
        successRate: 97.0
        totalProcessed: 100
        totalFailed: 3
        message: message
        results:
        - null
        - null
        errors:
        - null
        - null
        status: completed
      properties:
        status:
          description: Status of the bulk enrichment
          enum:
          - completed
          - failed
          example: completed
          type: string
        results:
          description: |
            Array of successfully enriched indicator results. Each item contains:
            - `indicator`: The original indicator value (e.g., "8.8.8.8" or "google.com")
            - `type`: "ip" or "domain"
            - `query`: Request metadata with type, value, timestamp, and response_time_ms
            - `summary`: Key information summary (organization, location, ASN, risk_score, etc.)

            For IP indicators:
            - `geolocation`: Country, city, coordinates, ISP details
            - `network`: BGP routing data if requested (visibility, origins, prefix info)
            - `isp`: ISP name, organization, ASN
            - `reputation`: Risk score and blacklist scores
            - `relationships`: Related domains and shared infrastructure

            For domain indicators:
            - `registration`: WHOIS data (registrar, dates, nameservers, status, registrant info)
            - `dns`: DNS records (A, AAAA, MX, NS, TXT, CNAME)
            - `reputation`: Domain reputation with infrastructure scores
            - `relationships`: Related domains, incoming/outgoing links
          items:
            $ref: "#/components/schemas/JsonNode"
          type: array
        errors:
          description: |
            Array of failed enrichment attempts. Each item contains:
            - `indicator`: The indicator that failed enrichment
            - `type`: "ip" or "domain"
            - `error`: true (boolean flag indicating this is an error entry)
            - `message`: Human-readable error description (e.g., "Timeout or error during enrichment")
          items:
            $ref: "#/components/schemas/JsonNode"
          type: array
        totalProcessed:
          description: Total number of indicators processed
          example: 100
          format: int32
          type: integer
        totalFailed:
          description: Total number of failed enrichments
          example: 3
          format: int32
          type: integer
        totalIndicators:
          description: Total number of indicators in the request
          example: 100
          format: int32
          type: integer
        successRate:
          description: Percentage of successful enrichments
          example: 97.0
          format: double
          type: number
        message:
          description: Error message if the entire job failed
          type: string
    SimilarCasesRequest:
      description: "Request for ML-based similar case matching. Finds historical incidents\
        \ similar to the current case based on indicators, behaviors, and TTPs."
      example:
        indicators:
        - 8.8.8.8
        - evil.com
        behaviorDescription: Suspicious outbound connections to known C2 infrastructure
        observedTTPs:
        - T1071
        - T1059
        minSimilarity: 0.7
        limit: 10
      properties:
        indicators:
          description: "List of indicators (IPs, domains, hashes, URLs) associated\
            \ with the current case. This is the primary matching criteria."
          example:
          - 8.8.8.8
          - evil-domain.com
          - 1.2.3.4
          items:
            type: string
          minItems: 1
          type: array
        behaviorDescription:
          description: Free-text description of observed malicious behavior or incident
            details. Improves matching accuracy by considering behavioral patterns.
          example: "Suspicious outbound connections to known C2 infrastructure, data\
            \ exfiltration attempts detected"
          type: string
        observedTTPs:
          description: Observed MITRE ATT&CK technique IDs. Helps find cases with
            similar attack techniques. See https://attack.mitre.org for reference.
          example:
          - T1071
          - T1566.001
          - T1059.001
          items:
            type: string
          type: array
        minSimilarity:
          default: "0.5"
          description: "Minimum similarity score threshold (0.0 to 1.0). Higher values\
            \ return fewer but more precise matches. Default: 0.5"
          example: 0.7
          format: double
          maximum: 1.0
          minimum: 0.0
          type: number
        limit:
          default: 10
          description: Maximum number of similar cases to return. Higher limits may
            increase processing time.
          example: 10
          format: int32
          maximum: 100
          minimum: 1
          type: integer
      required:
      - indicators
    SimilarCasesResult:
      description: Result of ML-based similar case matching
      example:
        similarCases: ""
        indicators:
        - indicators
        - indicators
        error: true
        message: message
        status: completed
      properties:
        indicators:
          description: List of indicators that were analyzed
          items:
            type: string
          type: array
        status:
          description: Status of the similar cases search
          example: completed
          type: string
        error:
          description: Whether an error occurred
          type: boolean
        message:
          description: Error message if the search failed
          type: string
        similarCases: {}
    PivotRequest:
      description: Request for intelligent infrastructure pivoting and relationship
        discovery
      example:
        indicator: evil.com
        indicatorType: domain
        depth: 2
        maxNodes: 100
      properties:
        indicator:
          description: "Starting indicator (IP address, domain, or hash) for pivot\
            \ analysis"
          example: evil.com
          minLength: 1
          type: string
        indicatorType:
          description: "Type of the starting indicator. Must be one of: ip, domain,\
            \ hash"
          enum:
          - ip
          - domain
          - hash
          example: domain
          minLength: 1
          pattern: ^(ip|domain|hash)$
          type: string
        depth:
          default: 1
          description: Pivot depth - how many hops to traverse from the starting indicator.
            Higher depth = more results but longer processing time.
          example: 2
          format: int32
          maximum: 3
          minimum: 1
          type: integer
        strategies:
          description: "Pivot strategies to use. Possible values: dns (DNS relationships),\
            \ whois (WHOIS data), ssl (SSL certificates), infrastructure (hosting),\
            \ passive_dns (historical DNS)"
          example:
          - dns
          - whois
          - ssl
          items:
            type: string
          type: array
        maxNodes:
          default: 100
          description: Maximum number of related nodes/indicators to discover. Limits
            result size for performance.
          example: 100
          format: int32
          maximum: 1000
          minimum: 1
          type: integer
      required:
      - indicator
      - indicatorType
    PivotResult:
      description: Result of AI infrastructure pivoting
      example:
        indicator: evil.com
        depth: 2
        indicatorType: domain
        pivot: ""
        error: true
        message: message
        status: completed
      properties:
        indicator:
          description: The starting indicator for pivoting
          example: evil.com
          type: string
        indicatorType:
          description: Type of the starting indicator
          example: domain
          type: string
        depth:
          description: Depth of pivot operation
          example: 2
          format: int32
          type: integer
        status:
          description: Status of the pivot operation
          example: completed
          type: string
        error:
          description: Whether an error occurred
          type: boolean
        message:
          description: Error message if the pivot failed
          type: string
        pivot: {}
    InvestigateContext:
      description: |
        Additional context to guide and enhance the investigation.
        All fields are optional but providing context improves investigation quality.
      example:
        hypothesis: Suspected C2 communication
        relatedIndicators:
        - 1.2.3.4
        - malware.com
        timeRange: 30d
        industry: financial
        region: us-east
      properties:
        hypothesis:
          description: Initial hypothesis or suspicion to focus the investigation.
            The AI will attempt to prove or disprove this theory.
          example: Suspected phishing campaign targeting financial sector
          type: string
        relatedIndicators:
          description: "Related indicators (IPs, domains, hashes) to include in the\
            \ investigation scope. Helps identify connections between indicators."
          example:
          - 1.2.3.4
          - malware.com
          - abc123def456
          items:
            type: string
          type: array
        timeRange:
          description: "Time range for historical analysis. Format: number + unit\
            \ (d=days, w=weeks, m=months). Examples: 7d, 2w, 3m, 90d"
          example: 30d
          type: string
        industry:
          description: Industry sector for contextualized threat analysis. Helps identify
            industry-specific threats and attack patterns.
          example: financial
          type: string
        region:
          description: Geographic region for localized threat intelligence. Helps
            identify region-specific threats.
          example: us-east
          type: string
    InvestigateRequest:
      description: "Request for comprehensive AI-powered threat investigation. Analyzes\
        \ indicators and returns verdict, timeline, and recommendations."
      example:
        indicator: 8.8.8.8
        indicatorType: ip
        depth: standard
        context:
          hypothesis: Suspicious outbound connection detected
          relatedIndicators:
          - malware.com
          timeRange: 30d
      properties:
        indicator:
          description: "The indicator to investigate (IP address, domain name, or\
            \ file hash)"
          example: 8.8.8.8
          minLength: 1
          type: string
        indicatorType:
          description: Type of indicator being investigated
          enum:
          - ip
          - domain
          - hash
          example: ip
          minLength: 1
          pattern: ^(ip|domain|hash)$
          type: string
        depth:
          default: standard
          description: "Investigation depth level. 'quick' (30-60s) for basic checks,\
            \ 'standard' (60-120s) for typical investigations, 'comprehensive' (120-300s)\
            \ for deep analysis."
          enum:
          - quick
          - standard
          - comprehensive
          example: comprehensive
          pattern: ^(quick|standard|comprehensive)$
          type: string
        context:
          $ref: "#/components/schemas/InvestigateContext"
      required:
      - indicator
      - indicatorType
    InvestigateResult:
      description: Result of an AI-powered threat investigation
      example:
        indicator: 8.8.8.8
        indicatorType: ip
        investigation: ""
        error: true
        message: message
        status: completed
      properties:
        indicator:
          description: The indicator that was investigated
          example: 8.8.8.8
          type: string
        indicatorType:
          description: Type of the indicator
          enum:
          - ip
          - domain
          - hash
          example: ip
          type: string
        status:
          description: Status of the investigation
          enum:
          - completed
          - failed
          example: completed
          type: string
        error:
          description: Whether an error occurred during investigation
          type: boolean
        message:
          description: Error message if the investigation failed
          type: string
        investigation: {}
    CorrelateOptions:
      description: |
        Configuration options for correlation analysis.
        All fields are optional and provide fine-grained control over correlation behavior.
      example:
        timeWindow: 30d
        correlationTypes:
        - infrastructure
        - campaign
        - actor
        minConfidence: 0.7
        includeIndustryBreakdown: true
        includeCampaignDetection: true
        includeGeographicSpread: false
        includeAttackPatterns: true
        anonymizationLevel: standard
      properties:
        timeWindow:
          description: "Time window for temporal correlation. Format: number + unit\
            \ (d=days, w=weeks, m=months). Examples: 7d, 2w, 3m"
          example: 30d
          type: string
        correlationTypes:
          description: "Types of correlation to analyze. Possible values: infrastructure,\
            \ campaign, actor, malware, technique"
          example:
          - infrastructure
          - campaign
          - actor
          items:
            type: string
          type: array
        minConfidence:
          description: Minimum confidence threshold for correlations (0.0 to 1.0).
            Higher values return fewer but more confident results.
          example: 0.7
          format: double
          maximum: 1.0
          minimum: 0.0
          type: number
        includeIndustryBreakdown:
          description: Include breakdown of indicator prevalence by industry sector
            in the response.
          example: true
          type: boolean
        includeCampaignDetection:
          description: Include campaign detection analysis to identify coordinated
            threat activity.
          example: true
          type: boolean
        includeGeographicSpread:
          description: Include geographic spread analysis showing indicator distribution
            across regions.
          example: false
          type: boolean
        includeAttackPatterns:
          description: Include attack pattern analysis based on MITRE ATT&CK framework.
          example: true
          type: boolean
        anonymizationLevel:
          description: "Level of data anonymization. Values: none, standard, strict"
          enum:
          - none
          - standard
          - strict
          example: standard
          type: string
    CorrelateRequest:
      description: Request for cross-customer indicator correlation analysis
      example:
        indicators:
        - 8.8.8.8
        - evil.com
        options:
          timeWindow: 30d
          minConfidence: 0.7
          includeIndustryBreakdown: true
      properties:
        indicators:
          description: "List of indicators (IPs, domains, hashes) to correlate across\
            \ global threat intelligence. Maximum 100 indicators per request."
          example:
          - 8.8.8.8
          - evil.com
          - 1.2.3.4
          items:
            type: string
          maxItems: 100
          minItems: 0
          type: array
        options:
          $ref: "#/components/schemas/CorrelateOptions"
      required:
      - indicators
    CorrelateResult:
      description: Result of global indicator correlation analysis
      example:
        correlation: ""
        indicators:
        - indicators
        - indicators
        error: true
        message: message
        status: completed
      properties:
        indicators:
          description: List of indicators that were correlated
          items:
            type: string
          type: array
        status:
          description: Status of the correlation analysis
          example: completed
          type: string
        error:
          description: Whether an error occurred
          type: boolean
        message:
          description: Error message if the correlation failed
          type: string
        correlation: {}
    AttributeRequest:
      description: Request for threat actor attribution and campaign clustering
      example:
        indicators:
        - 8.8.8.8
        - evil.com
        - malware.exe
        context:
          observedTTPs:
          - T1071
          - T1059
          targetedSector: financial
          targetRegion: US
      properties:
        indicators:
          description: "List of indicators (IPs, domains, hashes, URLs) for attribution\
            \ analysis. Maximum 500 indicators per request."
          example:
          - 8.8.8.8
          - evil.com
          - d41d8cd98f00b204e9800998ecf8427e
          items:
            type: string
          maxItems: 500
          minItems: 0
          type: array
        context:
          $ref: "#/components/schemas/AttributionContext"
      required:
      - indicators
    AttributionContext:
      description: |
        Context information to improve threat actor attribution accuracy.
        All fields are optional but providing more context improves attribution quality.
      example:
        observedTTPs:
        - T1071
        - T1059.001
        targetedSector: financial
        targetRegion: US
        timeframe: 2024-01-01 to 2024-12-31
        malwareFamilies:
        - Emotet
        - TrickBot
      properties:
        observedTTPs:
          description: Observed MITRE ATT&CK technique IDs. See https://attack.mitre.org
            for reference.
          example:
          - T1071
          - T1059.001
          - T1566.002
          items:
            type: string
          type: array
        targetedSector:
          description: "Targeted industry sector. Common values: financial, healthcare,\
            \ government, technology, energy, retail, manufacturing"
          example: financial
          type: string
        targetRegion:
          description: Geographic region of targets. Use ISO country codes or region
            names.
          example: US
          type: string
        timeframe:
          description: "Campaign timeframe for attribution. Format: 'YYYY-MM-DD to\
            \ YYYY-MM-DD' or descriptive like 'Q1 2024'"
          example: 2024-01-01 to 2024-12-31
          type: string
        malwareFamilies:
          description: Known malware families observed in the campaign. Helps narrow
            down threat actor candidates.
          example:
          - Emotet
          - TrickBot
          - Cobalt Strike
          items:
            type: string
          type: array
    AttributeResult:
      description: Result of threat actor attribution analysis
      example:
        attribution: ""
        indicators:
        - indicators
        - indicators
        error: true
        message: message
        status: completed
      properties:
        indicators:
          description: List of indicators that were analyzed
          items:
            type: string
          type: array
        status:
          description: Status of the attribution analysis
          example: completed
          type: string
        error:
          description: Whether an error occurred
          type: boolean
        message:
          description: Error message if the attribution failed
          type: string
        attribution: {}
    BulkIpLocationRequest:
      description: Request for bulk IP geolocation lookup
      example:
        ips:
        - 8.8.8.8
        - 1.1.1.1
        - 208.67.222.222
      properties:
        ips:
          description: List of IP addresses to lookup
          example:
          - 8.8.8.8
          - 1.1.1.1
          - 208.67.222.222
          items:
            type: string
          maxItems: 1000
          minItems: 0
          type: array
      required:
      - ips
    TrackedIndicator:
      description: A tracked indicator with its configuration and status
      example:
        next_check_at: 2024-12-07T15:30:00Z
        created_at: 2024-12-01T10:00:00Z
        last_check_at: 2024-12-06T15:30:00Z
        type: domain
        fields:
        - dns
        - whois
        - ssl
        total_changes: 3
        value: example.com
        enabled: true
        frequency: daily
      properties:
        type:
          description: "Indicator type: ip or domain"
          example: domain
          type: string
        value:
          description: Indicator value
          example: example.com
          type: string
        enabled:
          description: Whether tracking is currently enabled
          example: true
          type: boolean
        frequency:
          description: "Check frequency: hourly, daily, weekly"
          example: daily
          type: string
        fields:
          description: Fields being tracked
          example:
          - dns
          - whois
          - ssl
          items:
            type: string
          type: array
          uniqueItems: true
        created_at:
          description: When tracking was started
          example: 2024-12-01T10:00:00Z
          format: date-time
          type: string
        last_check_at:
          description: When the last check was performed
          example: 2024-12-06T15:30:00Z
          format: date-time
          type: string
        next_check_at:
          description: When the next check is scheduled
          example: 2024-12-07T15:30:00Z
          format: date-time
          type: string
        total_changes:
          description: Total number of changes detected
          example: 3
          format: int32
          type: integer
    TrackedIndicatorsResponse:
      description: Response containing a list of indicators being tracked for changes
      example:
        max_tracked: 50
        count: 5
        indicators:
        - next_check_at: 2024-12-07T15:30:00Z
          created_at: 2024-12-01T10:00:00Z
          last_check_at: 2024-12-06T15:30:00Z
          type: domain
          fields:
          - dns
          - whois
          - ssl
          total_changes: 3
          value: example.com
          enabled: true
          frequency: daily
        - next_check_at: 2024-12-07T15:30:00Z
          created_at: 2024-12-01T10:00:00Z
          last_check_at: 2024-12-06T15:30:00Z
          type: domain
          fields:
          - dns
          - whois
          - ssl
          total_changes: 3
          value: example.com
          enabled: true
          frequency: daily
      properties:
        count:
          description: Total number of tracked indicators
          example: 5
          format: int32
          type: integer
        max_tracked:
          description: Maximum number of indicators that can be tracked per API key
          example: 50
          format: int32
          type: integer
        indicators:
          description: List of tracked indicators
          items:
            $ref: "#/components/schemas/TrackedIndicator"
          type: array
    ChangeEvent:
      description: A single detected change event
      example:
        severity: severity
        newValue: ""
        field: field
        oldValue: ""
        category: category
        timestamp: 2000-01-23T04:56:07.000+00:00
      properties:
        timestamp:
          description: When the change was detected
          format: date-time
          type: string
        field:
          description: "Field that changed (dot notation, e.g., 'dns.a_record')"
          type: string
        oldValue: {}
        newValue: {}
        category:
          description: "Category of the change (dns, whois, ssl, etc.)"
          type: string
        severity:
          description: "Severity of the change: low, medium, high"
          type: string
    ChangeTrackingResponse:
      description: Change tracking response with configuration and detected changes
      example:
        indicator: indicator
        baselineCapturedAt: 2000-01-23T04:56:07.000+00:00
        success: true
        changes:
        - severity: severity
          newValue: ""
          field: field
          oldValue: ""
          category: category
          timestamp: 2000-01-23T04:56:07.000+00:00
        - severity: severity
          newValue: ""
          field: field
          oldValue: ""
          category: category
          timestamp: 2000-01-23T04:56:07.000+00:00
        baseline: ""
        type: type
        error: error
        tracking:
          createdAt: 2000-01-23T04:56:07.000+00:00
          lastCheck: 2000-01-23T04:56:07.000+00:00
          nextCheck: 2000-01-23T04:56:07.000+00:00
          fields:
          - fields
          - fields
          type: type
          value: value
          enabled: true
          frequency: frequency
          username: username
        totalChanges: 0
      properties:
        indicator:
          description: The indicator value (IP or domain)
          type: string
        type:
          description: "Indicator type: ip or domain"
          type: string
        tracking:
          $ref: "#/components/schemas/TrackingConfig"
        changes:
          description: List of detected changes
          items:
            $ref: "#/components/schemas/ChangeEvent"
          type: array
        baseline: {}
        baselineCapturedAt:
          description: When the baseline was captured
          format: date-time
          type: string
        totalChanges:
          description: Total number of changes detected
          format: int32
          type: integer
        error:
          description: Error message if operation failed
          type: string
        success:
          description: Whether the operation was successful
          type: boolean
    TrackingConfig:
      description: Change tracking configuration for an indicator
      example:
        createdAt: 2000-01-23T04:56:07.000+00:00
        lastCheck: 2000-01-23T04:56:07.000+00:00
        nextCheck: 2000-01-23T04:56:07.000+00:00
        fields:
        - fields
        - fields
        type: type
        value: value
        enabled: true
        frequency: frequency
        username: username
      properties:
        enabled:
          description: Whether tracking is currently enabled
          type: boolean
        fields:
          description: Fields being tracked for changes
          items:
            type: string
          type: array
        frequency:
          description: "Check frequency: hourly, daily, or weekly"
          type: string
        createdAt:
          description: When tracking was first started
          format: date-time
          type: string
        lastCheck:
          description: When the last check was performed
          format: date-time
          type: string
        nextCheck:
          description: When the next check is scheduled
          format: date-time
          type: string
        username:
          description: Username of the owner
          type: string
        type:
          description: "Indicator type: ip or domain"
          type: string
        value:
          description: Indicator value
          type: string
    ScreenshotSchedule:
      description: A scheduled screenshot configuration
      example:
        cron: 0
        next_capture_at: 2000-01-23T04:56:07.000+00:00
        capture_count: 0
        timezone: UTC
        created_at: 2000-01-23T04:56:07.000+00:00
        url: https://example.com
        enabled: true
        last_capture_at: 2000-01-23T04:56:07.000+00:00
        frequency: daily
        updated_at: 2000-01-23T04:56:07.000+00:00
        options:
          width: 1920
          height: 1080
          full_page: false
          wait_time: 2000
          format: png
          quality: 90
          javascript: true
          block_ads: false
        id: sched_abc123
        username: username
      properties:
        id:
          description: Unique identifier for this schedule
          example: sched_abc123
          type: string
        url:
          description: The URL to capture screenshots of
          example: https://example.com
          type: string
        username:
          description: Username/API key owner of this schedule
          type: string
        cron:
          description: Cron expression for scheduling (mutually exclusive with frequency)
          example: 0
          type: string
        frequency:
          description: Frequency preset (mutually exclusive with cron). Use one of
            the preset values for simplified scheduling.
          enum:
          - hourly
          - every_6_hours
          - every_12_hours
          - twice_daily
          - daily
          - weekly
          - monthly
          example: daily
          type: string
        timezone:
          description: Timezone for the schedule
          example: UTC
          type: string
        enabled:
          description: Whether this schedule is currently active
          example: true
          type: boolean
        options:
          $ref: "#/components/schemas/ScreenshotOptions"
        created_at:
          description: When this schedule was created
          format: date-time
          type: string
        updated_at:
          description: When this schedule was last updated
          format: date-time
          type: string
        last_capture_at:
          description: When the last screenshot was captured
          format: date-time
          type: string
        next_capture_at:
          description: When the next screenshot is scheduled
          format: date-time
          type: string
        capture_count:
          description: Total number of screenshots captured by this schedule
          format: int32
          type: integer
    ScreenshotScheduleListResponse:
      description: Response containing a list of screenshot schedules and quota information
      example:
        max_screenshots_per_schedule: 50
        schedules:
        - cron: 0
          next_capture_at: 2000-01-23T04:56:07.000+00:00
          capture_count: 0
          timezone: UTC
          created_at: 2000-01-23T04:56:07.000+00:00
          url: https://example.com
          enabled: true
          last_capture_at: 2000-01-23T04:56:07.000+00:00
          frequency: daily
          updated_at: 2000-01-23T04:56:07.000+00:00
          options:
            width: 1920
            height: 1080
            full_page: false
            wait_time: 2000
            format: png
            quality: 90
            javascript: true
            block_ads: false
          id: sched_abc123
          username: username
        - cron: 0
          next_capture_at: 2000-01-23T04:56:07.000+00:00
          capture_count: 0
          timezone: UTC
          created_at: 2000-01-23T04:56:07.000+00:00
          url: https://example.com
          enabled: true
          last_capture_at: 2000-01-23T04:56:07.000+00:00
          frequency: daily
          updated_at: 2000-01-23T04:56:07.000+00:00
          options:
            width: 1920
            height: 1080
            full_page: false
            wait_time: 2000
            format: png
            quality: 90
            javascript: true
            block_ads: false
          id: sched_abc123
          username: username
        count: 2
        max_schedules: 3
      properties:
        count:
          description: Number of schedules in this response
          example: 2
          format: int32
          type: integer
        max_schedules:
          description: Maximum number of schedules allowed per API key
          example: 3
          format: int32
          type: integer
        max_screenshots_per_schedule:
          description: Maximum number of screenshots retained per schedule
          example: 50
          format: int32
          type: integer
        schedules:
          description: List of screenshot schedules
          items:
            $ref: "#/components/schemas/ScreenshotSchedule"
          type: array
    ScheduleWithScreenshots:
      description: A schedule with its captured screenshots
      example:
        schedule_id: sched_abc123
        url: https://example.com
        screenshots:
        - format: png
          captured_at: 2024-12-01T10:30:00Z
          url: https://storage.whisper.security/screenshots/abc123.png
          file_size: 245760
          dimensions: 1920x1080
        - format: png
          captured_at: 2024-12-01T10:30:00Z
          url: https://storage.whisper.security/screenshots/abc123.png
          file_size: 245760
          dimensions: 1920x1080
      properties:
        schedule_id:
          description: Schedule ID
          example: sched_abc123
          type: string
        url:
          description: URL being captured
          example: https://example.com
          type: string
        screenshots:
          description: List of captured screenshots
          items:
            $ref: "#/components/schemas/ScreenshotEntry"
          type: array
    ScreenshotEntry:
      description: An individual screenshot capture record
      example:
        format: png
        captured_at: 2024-12-01T10:30:00Z
        url: https://storage.whisper.security/screenshots/abc123.png
        file_size: 245760
        dimensions: 1920x1080
      properties:
        url:
          description: URL to download the screenshot image
          example: https://storage.whisper.security/screenshots/abc123.png
          type: string
        captured_at:
          description: When the screenshot was captured
          example: 2024-12-01T10:30:00Z
          format: date-time
          type: string
        format:
          description: Image format
          example: png
          type: string
        dimensions:
          description: Image dimensions in pixels
          example: 1920x1080
          type: string
        file_size:
          description: File size in bytes
          example: 245760
          format: int64
          type: integer
    ScreenshotHistoryResponse:
      description: Response containing screenshot history for a target URL
      example:
        total_screenshots: 15
        schedules:
        - schedule_id: sched_abc123
          url: https://example.com
          screenshots:
          - format: png
            captured_at: 2024-12-01T10:30:00Z
            url: https://storage.whisper.security/screenshots/abc123.png
            file_size: 245760
            dimensions: 1920x1080
          - format: png
            captured_at: 2024-12-01T10:30:00Z
            url: https://storage.whisper.security/screenshots/abc123.png
            file_size: 245760
            dimensions: 1920x1080
        - schedule_id: sched_abc123
          url: https://example.com
          screenshots:
          - format: png
            captured_at: 2024-12-01T10:30:00Z
            url: https://storage.whisper.security/screenshots/abc123.png
            file_size: 245760
            dimensions: 1920x1080
          - format: png
            captured_at: 2024-12-01T10:30:00Z
            url: https://storage.whisper.security/screenshots/abc123.png
            file_size: 245760
            dimensions: 1920x1080
        limit: 10
        target: example.com
      properties:
        target:
          description: The target domain or URL queried
          example: example.com
          type: string
        schedules:
          description: List of schedules that captured screenshots of this target
          items:
            $ref: "#/components/schemas/ScheduleWithScreenshots"
          type: array
        total_screenshots:
          description: Total number of screenshots available for this target
          example: 15
          format: int32
          type: integer
        limit:
          description: Maximum number of screenshots returned (limit parameter)
          example: 10
          format: int32
          type: integer
    MonitorListResponse:
      description: List of monitoring checks with summary
      example:
        total: 10
        checks:
        - lastRunAt: 2000-01-23T04:56:07.000+00:00
          method: GET
          uptime30Days: 99.92
          responseTime: 245
          uptime7Days: 99.87
          type: api
          url: https://example.com/health
          enabled: true
          frequency: 10
          createdAt: 2000-01-23T04:56:07.000+00:00
          uptime24Hours: 99.95
          name: My Website Health
          locations:
          - us-east-1
          - eu-west-1
          id: abc123
          assertions:
            headers:
              key: headers
            dnsRecordValue: 93.184.216.34
            containsText: status
            notContainsText: error
            maxResponseTime: 3000
            sslDaysUntilExpiry: 30
            dnsRecordType: A
            statusCode: 200
          muted: false
          status: passing
          updatedAt: 2000-01-23T04:56:07.000+00:00
        - lastRunAt: 2000-01-23T04:56:07.000+00:00
          method: GET
          uptime30Days: 99.92
          responseTime: 245
          uptime7Days: 99.87
          type: api
          url: https://example.com/health
          enabled: true
          frequency: 10
          createdAt: 2000-01-23T04:56:07.000+00:00
          uptime24Hours: 99.95
          name: My Website Health
          locations:
          - us-east-1
          - eu-west-1
          id: abc123
          assertions:
            headers:
              key: headers
            dnsRecordValue: 93.184.216.34
            containsText: status
            notContainsText: error
            maxResponseTime: 3000
            sslDaysUntilExpiry: 30
            dnsRecordType: A
            statusCode: 200
          muted: false
          status: passing
          updatedAt: 2000-01-23T04:56:07.000+00:00
        pending: 0
        failing: 1
        passing: 8
        degraded: 1
      properties:
        checks:
          description: List of monitoring checks
          items:
            $ref: "#/components/schemas/MonitorCheckResponse"
          type: array
        total:
          description: Total number of checks
          example: 10
          format: int32
          type: integer
        passing:
          description: Number of passing checks
          example: 8
          format: int32
          type: integer
        failing:
          description: Number of failing checks
          example: 1
          format: int32
          type: integer
        degraded:
          description: Number of degraded checks
          example: 1
          format: int32
          type: integer
        pending:
          description: Number of pending checks (not yet run)
          example: 0
          format: int32
          type: integer
    MonitorResultListResponse:
      description: Response containing a list of check execution results
      example:
        count: 10
        check_id: abc123
        results:
        - hasErrors: true
          resultId: result-456
          success: true
          responseTime: 245
          errorMessage: Connection timeout
          location: us-east-1
          attempt: 1
          checkId: abc123
          timestamp: 2000-01-23T04:56:07.000+00:00
          statusCode: 200
        - hasErrors: true
          resultId: result-456
          success: true
          responseTime: 245
          errorMessage: Connection timeout
          location: us-east-1
          attempt: 1
          checkId: abc123
          timestamp: 2000-01-23T04:56:07.000+00:00
          statusCode: 200
      properties:
        check_id:
          description: ID of the check these results belong to
          example: abc123
          type: string
        count:
          description: Total number of results returned
          example: 10
          format: int32
          type: integer
        results:
          description: List of check execution results
          items:
            $ref: "#/components/schemas/MonitorResultResponse"
          type: array
    MonitorResultResponse:
      description: Result of a single check execution
      example:
        hasErrors: true
        resultId: result-456
        success: true
        responseTime: 245
        errorMessage: Connection timeout
        location: us-east-1
        attempt: 1
        checkId: abc123
        timestamp: 2000-01-23T04:56:07.000+00:00
        statusCode: 200
      properties:
        timestamp:
          description: When the check was executed
          format: date-time
          type: string
        success:
          description: Whether the check passed
          example: true
          type: boolean
        location:
          description: Location where check ran
          example: us-east-1
          type: string
        attempt:
          description: Check attempt number (for retries)
          example: 1
          format: int32
          type: integer
        checkId:
          description: ID of the check this result belongs to
          example: abc123
          type: string
        resultId:
          description: Unique result ID
          example: result-456
          type: string
        responseTime:
          description: Response time in milliseconds
          example: 245
          format: int64
          type: integer
        statusCode:
          description: HTTP status code received
          example: 200
          format: int32
          type: integer
        errorMessage:
          description: Error message if check failed
          example: Connection timeout
          type: string
        hasErrors:
          description: Whether check ran from all locations
          type: boolean
    MonitoringMetrics:
      description: Monitoring metrics and statistics for the target
      example:
        uptimePercentage: 99.95
        whoisChangeCount: 0
        currentStatus: healthy
        avgResponseTime: 245
        lastCheckAt: 2024-01-15T10:30:00Z
        dnsChangeCount: 2
        sslExpiresInDays: 45
      properties:
        uptimePercentage:
          description: Uptime percentage over the last 30 days
          example: 99.95
          format: double
          type: number
        avgResponseTime:
          description: Average response time in milliseconds
          example: 245
          format: int32
          type: integer
        sslExpiresInDays:
          description: Days until SSL certificate expires
          example: 45
          format: int32
          type: integer
        dnsChangeCount:
          description: Number of DNS change events detected
          example: 2
          format: int32
          type: integer
        whoisChangeCount:
          description: Number of WHOIS change events detected
          example: 0
          format: int32
          type: integer
        lastCheckAt:
          description: Timestamp of last successful check
          example: 2024-01-15T10:30:00Z
          type: string
        currentStatus:
          description: Current check status
          example: healthy
          type: string
    MonitoringStatusResponse:
      description: Monitoring status and metrics for a target domain or IP
      example:
        metrics:
          uptimePercentage: 99.95
          whoisChangeCount: 0
          currentStatus: healthy
          avgResponseTime: 245
          lastCheckAt: 2024-01-15T10:30:00Z
          dnsChangeCount: 2
          sslExpiresInDays: 45
        target: example.com
        status: active
      properties:
        target:
          description: The target domain or IP being monitored
          example: example.com
          type: string
        status:
          description: Current monitoring status
          enum:
          - active
          - inactive
          - error
          example: active
          type: string
        metrics:
          $ref: "#/components/schemas/MonitoringMetrics"
    MonitorDashboardResponse:
      description: Monitoring dashboard summary
      example:
        failingChecks: 1
        degradedChecks: 1
        lastUpdated: 2000-01-23T04:56:07.000+00:00
        passingChecks: 8
        totalChecks: 10
        avgUptime30Days: 99.92
        avgUptime24Hours: 99.95
        avgResponseTime: 312
        avgUptime7Days: 99.87
        checksByType:
          api: 8
          ssl: 1
          dns: 1
        checksByStatus:
          passing: 8
          failing: 1
          degraded: 1
        overallStatus: passing
      properties:
        totalChecks:
          description: Total number of checks
          example: 10
          format: int32
          type: integer
        passingChecks:
          description: Number of passing checks
          example: 8
          format: int32
          type: integer
        failingChecks:
          description: Number of failing checks
          example: 1
          format: int32
          type: integer
        degradedChecks:
          description: Number of degraded checks
          example: 1
          format: int32
          type: integer
        overallStatus:
          description: Overall status
          enum:
          - passing
          - failing
          - degraded
          example: passing
          type: string
        avgUptime24Hours:
          description: Average uptime percentage over the last 24 hours
          example: 99.95
          format: double
          type: number
        avgUptime7Days:
          description: Average uptime percentage over the last 7 days
          example: 99.87
          format: double
          type: number
        avgUptime30Days:
          description: Average uptime percentage over the last 30 days
          example: 99.92
          format: double
          type: number
        avgResponseTime:
          description: Average response time across all checks in milliseconds
          example: 312
          format: int64
          type: integer
        checksByType:
          additionalProperties:
            format: int32
            type: integer
          description: Count of checks by type
          example:
            api: 8
            ssl: 1
            dns: 1
        checksByStatus:
          additionalProperties:
            format: int32
            type: integer
          description: Count of checks by status
          example:
            passing: 8
            failing: 1
            degraded: 1
        lastUpdated:
          description: When this dashboard data was last updated
          format: date-time
          type: string
    Job:
      example:
        result: ""
        createdAt: 2000-01-23T04:56:07.000+00:00
        completedAt: 2000-01-23T04:56:07.000+00:00
        metadata:
          key: metadata
        progress:
          current: 0
          total: 6
          percentage: 1.4658129805029452
          message: message
        id: id
        type: type
        params: ""
        error:
          code: code
          details: details
          message: message
          timestamp: 2000-01-23T04:56:07.000+00:00
        status: PENDING
        updatedAt: 2000-01-23T04:56:07.000+00:00
        username: username
      properties:
        id:
          type: string
        status:
          enum:
          - PENDING
          - PROCESSING
          - COMPLETED
          - FAILED
          type: string
        type:
          type: string
        params: {}
        result: {}
        error:
          $ref: "#/components/schemas/JobError"
        progress:
          $ref: "#/components/schemas/JobProgress"
        createdAt:
          format: date-time
          type: string
        updatedAt:
          format: date-time
          type: string
        completedAt:
          format: date-time
          type: string
        metadata:
          additionalProperties:
            type: string
        username:
          type: string
    JobError:
      example:
        code: code
        details: details
        message: message
        timestamp: 2000-01-23T04:56:07.000+00:00
      properties:
        code:
          type: string
        message:
          type: string
        details:
          type: string
        timestamp:
          format: date-time
          type: string
    JobProgress:
      example:
        current: 0
        total: 6
        percentage: 1.4658129805029452
        message: message
      properties:
        current:
          format: int32
          type: integer
        total:
          format: int32
          type: integer
        message:
          type: string
        percentage:
          format: double
          type: number
    ErrorInfo:
      description: Job error information
      example:
        code: TIMEOUT
        message: Job timed out after 5 minutes
      properties:
        code:
          description: Error code
          example: TIMEOUT
          type: string
        message:
          description: Error message
          example: Job timed out after 5 minutes
          type: string
    JobListResponse:
      description: Paginated list of jobs with summary information
      example:
        total: 42
        offset: 0
        jobs:
        - jobId: f6250320-9ed4-442b-a389-acfda52d9375
          createdAt: 2025-01-15T10:30:00Z
          completedAt: 2025-01-15T10:30:05Z
          progress:
            current: 5
            total: 10
            message: Processing indicators...
          type: screenshot
          error:
            code: TIMEOUT
            message: Job timed out after 5 minutes
          status: COMPLETED
        - jobId: f6250320-9ed4-442b-a389-acfda52d9375
          createdAt: 2025-01-15T10:30:00Z
          completedAt: 2025-01-15T10:30:05Z
          progress:
            current: 5
            total: 10
            message: Processing indicators...
          type: screenshot
          error:
            code: TIMEOUT
            message: Job timed out after 5 minutes
          status: COMPLETED
        limit: 50
        status: COMPLETED
      properties:
        jobs:
          description: List of job summaries
          items:
            $ref: "#/components/schemas/JobSummary"
          type: array
        total:
          description: Total number of jobs matching the filter
          example: 42
          format: int64
          type: integer
        limit:
          description: Maximum number of jobs returned
          example: 50
          format: int32
          type: integer
        offset:
          description: Number of jobs skipped for pagination
          example: 0
          format: int32
          type: integer
        status:
          description: Status filter applied (if any)
          example: COMPLETED
          type: string
    JobSummary:
      description: Summary of a job
      example:
        jobId: f6250320-9ed4-442b-a389-acfda52d9375
        createdAt: 2025-01-15T10:30:00Z
        completedAt: 2025-01-15T10:30:05Z
        progress:
          current: 5
          total: 10
          message: Processing indicators...
        type: screenshot
        error:
          code: TIMEOUT
          message: Job timed out after 5 minutes
        status: COMPLETED
      properties:
        jobId:
          description: Unique job identifier
          example: f6250320-9ed4-442b-a389-acfda52d9375
          type: string
        type:
          description: Type of job
          example: screenshot
          type: string
        status:
          description: Current job status
          example: COMPLETED
          type: string
        createdAt:
          description: Job creation timestamp
          example: 2025-01-15T10:30:00Z
          type: string
        completedAt:
          description: Job completion timestamp (if completed)
          example: 2025-01-15T10:30:05Z
          type: string
        progress:
          $ref: "#/components/schemas/ProgressInfo"
        error:
          $ref: "#/components/schemas/ErrorInfo"
    ProgressInfo:
      description: Job progress information
      example:
        current: 5
        total: 10
        message: Processing indicators...
      properties:
        current:
          description: Current progress value
          example: 5
          format: int32
          type: integer
        total:
          description: Total expected progress value
          example: 10
          format: int32
          type: integer
        message:
          description: Progress message
          example: Processing indicators...
          type: string
    CypherSchemaResponse:
      description: |
        Graph database schema information including available node types,
        relationship types, and their properties.

        Use this to discover what data is available for querying.
      example:
        relationshipProperties:
          hasIP:
          - firstSeen
          - lastSeen
          isListed:
          - addedDate
        nodeCount: 15000000
        nodeLabels:
        - DomainName
        - A_ADDRESS
        - AAAA_ADDRESS
        - ASN
        - TLD
        relationshipTypes:
        - hasIP
        - hasIPv6
        - hasNameserver
        - hasMailHost
        - announces
        - isListed
        relationshipCount: 50000000
        nodeProperties:
          DomainName:
          - name
          - created
          A_ADDRESS:
          - name
          - firstSeen
          - lastSeen
      properties:
        nodeLabels:
          description: |
            Available node labels in the graph.

            Common node types:
            - `DomainName`: Domain names (e.g., google.com)
            - `A_ADDRESS`: IPv4 addresses
            - `AAAA_ADDRESS`: IPv6 addresses
            - `ASN`: Autonomous System Numbers
            - `ANNOUNCED_PREFIX_4`: IPv4 prefixes announced via BGP
            - `ANNOUNCED_PREFIX_6`: IPv6 prefixes announced via BGP
            - `Organisation`: Organisations owning ASNs
            - `Country`: Country information
            - `LIST`: Blocklist/whitelist entries
            - `LISTCATEGORY`: Categories of lists
            - `TLD`: Top-level domains
            - `TLSCA`: TLS Certificate Authorities
            - `TLSCert`: TLS Certificates
          example:
          - DomainName
          - A_ADDRESS
          - AAAA_ADDRESS
          - ASN
          - TLD
          items:
            type: string
          type: array
        relationshipTypes:
          description: |
            Available relationship types in the graph.

            Common relationships:
            - `hasIP`: Domain → A_ADDRESS (DNS A record)
            - `hasIPv6`: Domain → AAAA_ADDRESS (DNS AAAA record)
            - `hasNameserver`: Domain → DomainName (NS record)
            - `hasMailHost`: Domain → DomainName (MX record)
            - `hasTLD`: Domain → TLD
            - `announces`: ASN → ANNOUNCED_PREFIX
            - `inASN`: IP_PREFIX → ASN
            - `isListed`: IP/Domain → LIST (blocklist membership)
            - `hasCA`: TLSCert → TLSCA
            - `isIssuer`: TLSCA → TLSCert
            - `isSubjectOf`: DomainName → TLSCert
          example:
          - hasIP
          - hasIPv6
          - hasNameserver
          - hasMailHost
          - announces
          - isListed
          items:
            type: string
          type: array
        nodeProperties:
          additionalProperties:
            items:
              type: string
          description: "Properties available on each node type, keyed by node label"
          example:
            DomainName:
            - name
            - created
            A_ADDRESS:
            - name
            - firstSeen
            - lastSeen
        relationshipProperties:
          additionalProperties:
            items:
              type: string
          description: "Properties available on each relationship type, keyed by relationship\
            \ type"
          example:
            hasIP:
            - firstSeen
            - lastSeen
            isListed:
            - addedDate
        nodeCount:
          description: Total number of nodes in the graph
          example: 15000000
          format: int64
          type: integer
        relationshipCount:
          description: Total number of relationships in the graph
          example: 50000000
          format: int64
          type: integer
    BenchmarkInfo:
      description: Benchmark metadata
      example:
        collectionPeriod: collectionPeriod
        dataAsOf: dataAsOf
        sampleSize: 1250
      properties:
        dataAsOf:
          description: Data freshness timestamp
          type: string
        sampleSize:
          description: Sample size for benchmark
          example: 1250
          format: int32
          type: integer
        collectionPeriod:
          description: Data collection period
          type: string
    BenchmarkMetrics:
      description: Key security metrics
      example:
        falsePositiveRate: 12.3
        incidentsPerMonth: 8.5
        mttdHours: 4.5
        mttrHours: 12.3
        detectionRate: 78.5
        averageRiskScore: 45.2
      properties:
        averageRiskScore:
          description: Average risk score
          example: 45.2
          format: double
          type: number
        mttdHours:
          description: Mean time to detect (hours)
          example: 4.5
          format: double
          type: number
        mttrHours:
          description: Mean time to respond (hours)
          example: 12.3
          format: double
          type: number
        detectionRate:
          description: Detection rate percentage
          example: 78.5
          format: double
          type: number
        falsePositiveRate:
          description: False positive rate percentage
          example: 12.3
          format: double
          type: number
        incidentsPerMonth:
          description: Average incidents per month
          example: 8.5
          format: double
          type: number
    BenchmarkResponse:
      description: Industry-wide security benchmark metrics for peer comparison
      example:
        percentiles:
          p25: 32.1
          p90: 72.1
          p50: 44.8
          p75: 58.3
        query:
          indicator: indicator
          history_type: history_type
          indicator_type: indicator_type
          response_time_ms: 0
          timestamp: timestamp
        threatProfile:
          topThreats:
          - topThreats
          - topThreats
          targetedAssets:
          - targetedAssets
          - targetedAssets
          commonVectors:
          - commonVectors
          - commonVectors
          attackFrequency: attackFrequency
        benchmarkInfo:
          collectionPeriod: collectionPeriod
          dataAsOf: dataAsOf
          sampleSize: 1250
        industry:
          code: financial_services
          displayName: Financial Services
          description: description
        metrics:
          falsePositiveRate: 12.3
          incidentsPerMonth: 8.5
          mttdHours: 4.5
          mttrHours: 12.3
          detectionRate: 78.5
          averageRiskScore: 45.2
        trends:
          changePercent: 6.027456183070403
          riskTrend30d: riskTrend30d
          direction: improving
      properties:
        query:
          $ref: "#/components/schemas/QueryInfo"
        industry:
          $ref: "#/components/schemas/IndustryInfo"
        metrics:
          $ref: "#/components/schemas/BenchmarkMetrics"
        percentiles:
          $ref: "#/components/schemas/PercentileInfo"
        threatProfile:
          $ref: "#/components/schemas/ThreatProfile"
        trends:
          $ref: "#/components/schemas/TrendData"
        benchmarkInfo:
          $ref: "#/components/schemas/BenchmarkInfo"
    IndustryInfo:
      description: Industry identification
      example:
        code: financial_services
        displayName: Financial Services
        description: description
      properties:
        code:
          description: Industry code
          example: financial_services
          type: string
        description:
          description: Industry description
          type: string
        displayName:
          description: Display name
          example: Financial Services
          type: string
    PercentileInfo:
      description: Percentile distribution
      example:
        p25: 32.1
        p90: 72.1
        p50: 44.8
        p75: 58.3
      properties:
        p25:
          description: 25th percentile risk score
          example: 32.1
          format: double
          type: number
        p50:
          description: 50th percentile risk score (median)
          example: 44.8
          format: double
          type: number
        p75:
          description: 75th percentile risk score
          example: 58.3
          format: double
          type: number
        p90:
          description: 90th percentile risk score
          example: 72.1
          format: double
          type: number
    QueryInfo:
      example:
        indicator: indicator
        history_type: history_type
        indicator_type: indicator_type
        response_time_ms: 0
        timestamp: timestamp
      properties:
        indicator:
          type: string
        indicator_type:
          type: string
        history_type:
          type: string
        timestamp:
          type: string
        response_time_ms:
          format: int64
          type: integer
    ThreatProfile:
      description: Industry threat landscape
      example:
        topThreats:
        - topThreats
        - topThreats
        targetedAssets:
        - targetedAssets
        - targetedAssets
        commonVectors:
        - commonVectors
        - commonVectors
        attackFrequency: attackFrequency
      properties:
        topThreats:
          description: Top threat types
          items:
            type: string
          type: array
        commonVectors:
          description: Common attack vectors
          items:
            type: string
          type: array
        attackFrequency:
          description: Average attack frequency per month
          type: string
        targetedAssets:
          description: Most targeted assets
          items:
            type: string
          type: array
    TrendData:
      description: Historical trend data
      example:
        changePercent: 6.027456183070403
        riskTrend30d: riskTrend30d
        direction: improving
      properties:
        direction:
          description: Trend direction
          example: improving
          type: string
        riskTrend30d:
          description: 30-day risk trend
          type: string
        changePercent:
          description: Risk score change percentage
          format: double
          type: number
    CityInfo:
      description: City-level geographic information
      example:
        originalName: Mountain View
        confidence: 80
        name: mountain view
      properties:
        name:
          description: Normalized city name (lowercase)
          example: mountain view
          type: string
        originalName:
          description: Original city name with proper capitalization
          example: Mountain View
          type: string
        confidence:
          description: Confidence score for city detection (0-100)
          example: 80
          format: int32
          maximum: 100
          minimum: 0
          type: integer
    CoordinatesInfo:
      description: Geographic coordinates as a convenience object
      example:
        latitude: 37.4223
        longitude: -122.085
      properties:
        latitude:
          description: Latitude coordinate
          example: 37.4223
          format: double
          type: number
        longitude:
          description: Longitude coordinate
          example: -122.085
          format: double
          type: number
    CountryInfo:
      description: Country-level geographic information
      example:
        isoCode: US
        confidence: 95
        name: United States
      properties:
        isoCode:
          description: ISO 3166-1 alpha-2 country code
          example: US
          type: string
        name:
          description: Full country name in English
          example: United States
          type: string
        confidence:
          description: Confidence score for country detection (0-100)
          example: 95
          format: int32
          maximum: 100
          minimum: 0
          type: integer
    IpGeolocationResponse:
      description: Geolocation and network information for an IP address
      example:
        country:
          isoCode: US
          confidence: 95
          name: United States
        traits:
          isTorExitNode: false
          isAnonymousProxy: false
          isVpn: false
          userType: hosting
        city:
          originalName: Mountain View
          confidence: 80
          name: mountain view
        ip: 8.8.8.8
        isp:
          organization: Level 3
          name: Google LLC
          asn: 15169
          asnOrganization: Google LLC
        coordinates:
          latitude: 37.4223
          longitude: -122.085
        location:
          accuracyRadius: 20
          latitude: 37.4223
          timeZone: America/Los_Angeles
          longitude: -122.085
      properties:
        ip:
          description: The queried IP address
          example: 8.8.8.8
          type: string
        country:
          $ref: "#/components/schemas/CountryInfo"
        city:
          $ref: "#/components/schemas/CityInfo"
        location:
          $ref: "#/components/schemas/LocationInfo"
        isp:
          $ref: "#/components/schemas/IspInfo"
        traits:
          $ref: "#/components/schemas/TraitsInfo"
        coordinates:
          $ref: "#/components/schemas/CoordinatesInfo"
    IspInfo:
      description: Internet Service Provider and Autonomous System information
      example:
        organization: Level 3
        name: Google LLC
        asn: 15169
        asnOrganization: Google LLC
      properties:
        name:
          description: ISP name
          example: Google LLC
          type: string
        organization:
          description: Organization that owns/operates this IP range
          example: Level 3
          type: string
        asn:
          description: Autonomous System Number
          example: 15169
          format: int32
          type: integer
        asnOrganization:
          description: Organization name associated with the ASN
          example: Google LLC
          type: string
    LocationInfo:
      description: Detailed location information including coordinates and timezone
      example:
        accuracyRadius: 20
        latitude: 37.4223
        timeZone: America/Los_Angeles
        longitude: -122.085
      properties:
        latitude:
          description: Latitude coordinate
          example: 37.4223
          format: double
          type: number
        longitude:
          description: Longitude coordinate
          example: -122.085
          format: double
          type: number
        accuracyRadius:
          description: Accuracy radius in kilometers - actual location is within this
            radius
          example: 20
          format: int32
          type: integer
        timeZone:
          description: IANA timezone identifier
          example: America/Los_Angeles
          type: string
    TraitsInfo:
      description: IP classification and behavioral traits
      example:
        isTorExitNode: false
        isAnonymousProxy: false
        isVpn: false
        userType: hosting
      properties:
        userType:
          description: Classification of the IP address based on its typical use
          enum:
          - residential
          - business
          - hosting
          - isp
          - cellular
          - education
          - government
          - military
          example: hosting
          type: string
        isAnonymousProxy:
          description: Whether this IP is associated with anonymous proxy services
          example: false
          type: boolean
        isTorExitNode:
          description: Whether this IP is a known Tor exit node
          example: false
          type: boolean
        isVpn:
          description: Whether this IP is associated with a VPN service
          example: false
          type: boolean
    BlacklistScores:
      description: Blacklist scores at different network levels
      example:
        prefix_score: 1.2
        asn_score: 0.8
        ip_score: 0.5
      properties:
        ip_score:
          description: IP-level blacklist score
          example: 0.5
          format: double
          maximum: 10
          minimum: 0
          type: number
        prefix_score:
          description: Network prefix blacklist score
          example: 1.2
          format: double
          maximum: 10
          minimum: 0
          type: number
        asn_score:
          description: ASN-level blacklist score
          example: 0.8
          format: double
          maximum: 10
          minimum: 0
          type: number
    DnsInfo:
      description: DNS records and resolution data for the domain
      example:
        a_records:
        - 8.8.8.8
        - 8.8.4.4
        mx_records:
        - null
        - null
        aaaa_records:
        - 2001:4860:4860::8888
        txt_records:
        - txt_records
        - txt_records
        cname_records:
        - cname_records
        - cname_records
        arecords:
        - arecords
        - arecords
        ns_records:
        - ns1.google.com
        - ns2.google.com
      properties:
        arecords:
          items:
            type: string
          type: array
        a_records:
          description: A records (IPv4 addresses)
          example:
          - 8.8.8.8
          - 8.8.4.4
          items:
            type: string
          type: array
        aaaa_records:
          description: AAAA records (IPv6 addresses)
          example:
          - 2001:4860:4860::8888
          items:
            type: string
          type: array
        mx_records:
          description: MX records (mail servers) with priority and hostname
          items:
            $ref: "#/components/schemas/JsonNode"
          type: array
        ns_records:
          description: NS records (name servers)
          example:
          - ns1.google.com
          - ns2.google.com
          items:
            type: string
          type: array
        txt_records:
          description: "TXT records (text records for SPF, DKIM, etc.)"
          items:
            type: string
          type: array
        cname_records:
          description: CNAME records (canonical name aliases)
          items:
            type: string
          type: array
    DomainReputationDetails:
      description: Detailed infrastructure and individual IP scores
      example:
        domain_ip_scores:
          key: 0.8008281904610115
        domain_ips:
        - 8.8.8.8
        nameserver_ips:
        - 1.1.1.1
        - 1.0.0.1
        nameserver_domains:
        - ns1.example.com
        - ns2.example.com
        nameserver_ip_scores:
          key: 6.027456183070403
        mailserver_domains:
        - mail.example.com
        mailserver_ips:
        - 74.125.28.27
        mailserver_ip_scores:
          key: 1.4658129805029452
      properties:
        domain_ips:
          description: Domain's A record IP addresses
          example:
          - 8.8.8.8
          items:
            type: string
          type: array
        domain_ip_scores:
          additionalProperties:
            format: double
            type: number
          description: Individual scores for each domain IP
        nameserver_domains:
          description: Nameserver domain names
          example:
          - ns1.example.com
          - ns2.example.com
          items:
            type: string
          type: array
        nameserver_ips:
          description: IP addresses of nameservers
          example:
          - 1.1.1.1
          - 1.0.0.1
          items:
            type: string
          type: array
        nameserver_ip_scores:
          additionalProperties:
            format: double
            type: number
          description: Individual scores for each nameserver IP
        mailserver_domains:
          description: Mail server domain names
          example:
          - mail.example.com
          items:
            type: string
          type: array
        mailserver_ips:
          description: IP addresses of mail servers
          example:
          - 74.125.28.27
          items:
            type: string
          type: array
        mailserver_ip_scores:
          additionalProperties:
            format: double
            type: number
          description: Individual scores for each mail server IP
    DomainReputationScores:
      description: Domain reputation calculated from infrastructure IP scores
      example:
        scoring_method: composite_infrastructure
        risk_level: medium_risk
        mailserver_ip_score: 32.1
        nameserver_ip_score: 45.2
        domain_ip_score: 85.5
        details:
          domain_ip_scores:
            key: 0.8008281904610115
          domain_ips:
          - 8.8.8.8
          nameserver_ips:
          - 1.1.1.1
          - 1.0.0.1
          nameserver_domains:
          - ns1.example.com
          - ns2.example.com
          nameserver_ip_scores:
            key: 6.027456183070403
          mailserver_domains:
          - mail.example.com
          mailserver_ips:
          - 74.125.28.27
          mailserver_ip_scores:
            key: 1.4658129805029452
        weights:
          key: 5.962133916683182
        overall_score: 51.3
      properties:
        overall_score:
          description: "Overall reputation score (0-100, higher = more suspicious)"
          example: 51.3
          format: double
          maximum: 100
          minimum: 0
          type: number
        risk_level:
          description: Risk classification based on overall score
          enum:
          - clean
          - low_risk
          - medium_risk
          - high_risk
          - malicious
          example: medium_risk
          type: string
        domain_ip_score:
          description: Average IP reputation score for domain's A records
          example: 85.5
          format: double
          maximum: 100
          minimum: 0
          type: number
        nameserver_ip_score:
          description: Average IP reputation score for nameserver IPs
          example: 45.2
          format: double
          maximum: 100
          minimum: 0
          type: number
        mailserver_ip_score:
          description: Average IP reputation score for mail server IPs
          example: 32.1
          format: double
          maximum: 100
          minimum: 0
          type: number
        details:
          $ref: "#/components/schemas/DomainReputationDetails"
        scoring_method:
          description: Scoring methodology used
          example: composite_infrastructure
          type: string
        weights:
          additionalProperties:
            format: double
            type: number
          description: Weighting strategy applied to infrastructure components
    IndicatorResponse:
      description: Comprehensive intelligence response for an IP address or domain
        indicator
      example:
        summary:
          registrar: MarkMonitor Inc.
          risk_score: 1.2
          asn_primary: AS15169
          ip_type: datacenter
          expiration_date: 2028-09-14
          total_links_out: 89
          network: 8.8.8.0/24
          domain_name: google.com
          registration_date: 1997-09-15
          total_links_in: 1523
          organization: Google LLC
          dns_provider: Cloudflare
          location: "Mountain View, California, US"
          total_domains: 142
          status: active
        ip_intelligence:
          key: null
        metadata:
          data_sources:
          - geolocation_db
          - whois_api
          - dns_resolver
          - threat_feeds
          errors:
          - threat_feed_timeout
          - historical_whois_unavailable
        query:
          indicator: indicator
          history_type: history_type
          indicator_type: indicator_type
          response_time_ms: 0
          timestamp: timestamp
        isp: ""
        dns:
          a_records:
          - 8.8.8.8
          - 8.8.4.4
          mx_records:
          - null
          - null
          aaaa_records:
          - 2001:4860:4860::8888
          txt_records:
          - txt_records
          - txt_records
          cname_records:
          - cname_records
          - cname_records
          arecords:
          - arecords
          - arecords
          ns_records:
          - ns1.google.com
          - ns2.google.com
        reputation:
          domain_reputation:
            scoring_method: composite_infrastructure
            risk_level: medium_risk
            mailserver_ip_score: 32.1
            nameserver_ip_score: 45.2
            domain_ip_score: 85.5
            details:
              domain_ip_scores:
                key: 0.8008281904610115
              domain_ips:
              - 8.8.8.8
              nameserver_ips:
              - 1.1.1.1
              - 1.0.0.1
              nameserver_domains:
              - ns1.example.com
              - ns2.example.com
              nameserver_ip_scores:
                key: 6.027456183070403
              mailserver_domains:
              - mail.example.com
              mailserver_ips:
              - 74.125.28.27
              mailserver_ip_scores:
                key: 1.4658129805029452
            weights:
              key: 5.962133916683182
            overall_score: 51.3
          risk_score: 2.3
          blacklists:
            prefix_score: 1.2
            asn_score: 0.8
            ip_score: 0.5
        rpki: ""
        network: ""
        routing: ""
        relationships:
          related_domains:
          - google.co.uk
          - google.ca
          - google.de
          shared_infrastructure:
          - youtube.com
          - gmail.com
          incoming_links:
            total: 1523
            top_destinations:
            - accounts.google.com
            - support.google.com
            top_sources:
            - example.com
            - test.org
          outgoing_links:
            total: 1523
            top_destinations:
            - accounts.google.com
            - support.google.com
            top_sources:
            - example.com
            - test.org
        security: ""
        registration: ""
        geolocation: ""
      properties:
        query:
          $ref: "#/components/schemas/QueryInfo"
        summary:
          $ref: "#/components/schemas/SummaryInfo"
        geolocation: {}
        network: {}
        routing: {}
        isp: {}
        registration: {}
        dns:
          $ref: "#/components/schemas/DnsInfo"
        relationships:
          $ref: "#/components/schemas/RelationshipInfo"
        reputation:
          $ref: "#/components/schemas/ReputationInfo"
        security: {}
        rpki: {}
        ip_intelligence:
          additionalProperties:
            $ref: "#/components/schemas/JsonNode"
          description: "When domain is queried with include=ip_intelligence, contains\
            \ full intelligence for each resolved IP"
        metadata:
          $ref: "#/components/schemas/MetadataInfo"
    LinksInfo:
      description: Link statistics and top sources/destinations
      example:
        total: 1523
        top_destinations:
        - accounts.google.com
        - support.google.com
        top_sources:
        - example.com
        - test.org
      properties:
        total:
          description: Total number of links
          example: 1523
          format: int32
          type: integer
        top_sources:
          description: Top linking sources (for incoming links)
          example:
          - example.com
          - test.org
          items:
            type: string
          type: array
        top_destinations:
          description: Top link destinations (for outgoing links)
          example:
          - accounts.google.com
          - support.google.com
          items:
            type: string
          type: array
    MetadataInfo:
      description: Response metadata including data sources and any errors encountered
      example:
        data_sources:
        - geolocation_db
        - whois_api
        - dns_resolver
        - threat_feeds
        errors:
        - threat_feed_timeout
        - historical_whois_unavailable
      properties:
        data_sources:
          description: List of data sources used to build this response
          example:
          - geolocation_db
          - whois_api
          - dns_resolver
          - threat_feeds
          items:
            type: string
          type: array
        errors:
          description: Any non-fatal errors encountered during data collection. Empty
            if all sources succeeded.
          example:
          - threat_feed_timeout
          - historical_whois_unavailable
          items:
            type: string
          type: array
    RelationshipInfo:
      description: Connections and relationships to other infrastructure and domains
      example:
        related_domains:
        - google.co.uk
        - google.ca
        - google.de
        shared_infrastructure:
        - youtube.com
        - gmail.com
        incoming_links:
          total: 1523
          top_destinations:
          - accounts.google.com
          - support.google.com
          top_sources:
          - example.com
          - test.org
        outgoing_links:
          total: 1523
          top_destinations:
          - accounts.google.com
          - support.google.com
          top_sources:
          - example.com
          - test.org
      properties:
        incoming_links:
          $ref: "#/components/schemas/LinksInfo"
        outgoing_links:
          $ref: "#/components/schemas/LinksInfo"
        related_domains:
          description: "Related domains (same owner, same network, similar content)"
          example:
          - google.co.uk
          - google.ca
          - google.de
          items:
            type: string
          type: array
        shared_infrastructure:
          description: "Other assets sharing the same infrastructure (IP, ASN, nameservers)"
          example:
          - youtube.com
          - gmail.com
          items:
            type: string
          type: array
    ReputationInfo:
      description: Reputation scoring and blacklist information for threat assessment
      example:
        domain_reputation:
          scoring_method: composite_infrastructure
          risk_level: medium_risk
          mailserver_ip_score: 32.1
          nameserver_ip_score: 45.2
          domain_ip_score: 85.5
          details:
            domain_ip_scores:
              key: 0.8008281904610115
            domain_ips:
            - 8.8.8.8
            nameserver_ips:
            - 1.1.1.1
            - 1.0.0.1
            nameserver_domains:
            - ns1.example.com
            - ns2.example.com
            nameserver_ip_scores:
              key: 6.027456183070403
            mailserver_domains:
            - mail.example.com
            mailserver_ips:
            - 74.125.28.27
            mailserver_ip_scores:
              key: 1.4658129805029452
          weights:
            key: 5.962133916683182
          overall_score: 51.3
        risk_score: 2.3
        blacklists:
          prefix_score: 1.2
          asn_score: 0.8
          ip_score: 0.5
      properties:
        risk_score:
          description: "Composite risk score (0-10, higher = riskier)"
          example: 2.3
          format: double
          maximum: 10
          minimum: 0
          type: number
        blacklists:
          $ref: "#/components/schemas/BlacklistScores"
        domain_reputation:
          $ref: "#/components/schemas/DomainReputationScores"
    SummaryInfo:
      description: Executive summary with the most important facts for quick decision-making
      example:
        registrar: MarkMonitor Inc.
        risk_score: 1.2
        asn_primary: AS15169
        ip_type: datacenter
        expiration_date: 2028-09-14
        total_links_out: 89
        network: 8.8.8.0/24
        domain_name: google.com
        registration_date: 1997-09-15
        total_links_in: 1523
        organization: Google LLC
        dns_provider: Cloudflare
        location: "Mountain View, California, US"
        total_domains: 142
        status: active
      properties:
        organization:
          description: Primary organization name
          example: Google LLC
          type: string
        location:
          description: Primary location
          example: "Mountain View, California, US"
          type: string
        network:
          description: Network range or CIDR
          example: 8.8.8.0/24
          type: string
        registrar:
          description: Domain registrar
          example: MarkMonitor Inc.
          type: string
        status:
          description: Domain status
          enum:
          - active
          - expired
          - pending
          - suspended
          - deleted
          example: active
          type: string
        asn_primary:
          description: Primary ASN
          example: AS15169
          type: string
        risk_score:
          description: "Composite risk score (0-10, higher is riskier)"
          example: 1.2
          format: double
          maximum: 10
          minimum: 0
          type: number
        ip_type:
          description: IP classification
          enum:
          - residential
          - business
          - datacenter
          - hosting
          - vpn
          - proxy
          - tor
          - mobile
          example: datacenter
          type: string
        total_domains:
          description: Total number of domains resolving to this IP
          example: 142
          format: int32
          type: integer
        domain_name:
          description: The domain name
          example: google.com
          type: string
        registration_date:
          description: Domain registration date
          example: 1997-09-15
          type: string
        expiration_date:
          description: Domain expiration date
          example: 2028-09-14
          type: string
        dns_provider:
          description: Primary DNS provider
          example: Cloudflare
          type: string
        total_links_in:
          description: Number of incoming links/backlinks
          example: 1523
          format: int32
          type: integer
        total_links_out:
          description: Number of outgoing links
          example: 89
          format: int32
          type: integer
    CurrentAssessment:
      description: Current risk state
      example:
        riskLevel: medium_risk
        confidence: 0.89
        assessedAt: assessedAt
        riskScore: 42.5
      properties:
        confidence:
          description: Confidence in assessment (0-1)
          example: 0.89
          format: double
          type: number
        riskScore:
          description: Current risk score (0-100)
          example: 42.5
          format: double
          type: number
        riskLevel:
          description: Risk level category
          example: medium_risk
          type: string
        assessedAt:
          description: Assessment timestamp
          type: string
    EarlyWarning:
      description: Early warning signal
      example:
        severity: medium
        detectedAt: detectedAt
        type: infrastructure_shift
        message: message
      properties:
        type:
          description: Warning type
          example: infrastructure_shift
          type: string
        severity:
          description: Severity level
          example: medium
          type: string
        message:
          description: Warning message
          type: string
        detectedAt:
          description: Detection timestamp
          type: string
    ModelInfo:
      description: ML model information
      example:
        lastUpdated: lastUpdated
        version: bison-v1.2.0
      properties:
        version:
          description: Model version
          example: bison-v1.2.0
          type: string
        lastUpdated:
          description: Last updated timestamp
          type: string
    PatternMatching:
      description: Pattern matching insights
      example:
        matchedPatterns:
        - matchedPatterns
        - matchedPatterns
        confidence: 0.8008281904610115
      properties:
        confidence:
          description: Pattern confidence score
          format: double
          type: number
        matchedPatterns:
          description: Matched pattern types
          items:
            type: string
          type: array
    PredictionPoint:
      description: A single prediction point
      example:
        confidence: 0.75
        predictedLevel: high_risk
        predictedScore: 55.2
      properties:
        confidence:
          description: Prediction confidence (0-1)
          example: 0.75
          format: double
          type: number
        predictedScore:
          description: Predicted risk score
          example: 55.2
          format: double
          type: number
        predictedLevel:
          description: Predicted risk level
          example: high_risk
          type: string
    Predictions:
      description: Future risk predictions
      example:
        day7:
          confidence: 0.75
          predictedLevel: high_risk
          predictedScore: 55.2
        day30:
          confidence: 0.75
          predictedLevel: high_risk
          predictedScore: 55.2
      properties:
        day7:
          $ref: "#/components/schemas/PredictionPoint"
        day30:
          $ref: "#/components/schemas/PredictionPoint"
    PredictiveRiskResponse:
      description: ML-based predictive risk assessment for an indicator
      example:
        riskFactors:
        - contribution: 14.9
          weight: 0.35
          description: description
          factor: historical_malicious_activity
        - contribution: 14.9
          weight: 0.35
          description: description
          factor: historical_malicious_activity
        patternMatching:
          matchedPatterns:
          - matchedPatterns
          - matchedPatterns
          confidence: 0.8008281904610115
        modelInfo:
          lastUpdated: lastUpdated
          version: bison-v1.2.0
        query:
          indicator: indicator
          history_type: history_type
          indicator_type: indicator_type
          response_time_ms: 0
          timestamp: timestamp
        currentAssessment:
          riskLevel: medium_risk
          confidence: 0.89
          assessedAt: assessedAt
          riskScore: 42.5
        similarCases:
        - similarity: 0.87
          caseId: caseId
          outcome: confirmed_malicious
        - similarity: 0.87
          caseId: caseId
          outcome: confirmed_malicious
        trajectory:
          trend: increasing
          velocity: moderate
          stability: stable
        earlyWarnings:
        - severity: medium
          detectedAt: detectedAt
          type: infrastructure_shift
          message: message
        - severity: medium
          detectedAt: detectedAt
          type: infrastructure_shift
          message: message
        predictions:
          day7:
            confidence: 0.75
            predictedLevel: high_risk
            predictedScore: 55.2
          day30:
            confidence: 0.75
            predictedLevel: high_risk
            predictedScore: 55.2
      properties:
        query:
          $ref: "#/components/schemas/QueryInfo"
        currentAssessment:
          $ref: "#/components/schemas/CurrentAssessment"
        predictions:
          $ref: "#/components/schemas/Predictions"
        trajectory:
          $ref: "#/components/schemas/TrajectoryInfo"
        riskFactors:
          description: Contributing risk factors
          items:
            $ref: "#/components/schemas/RiskFactor"
          type: array
        patternMatching:
          $ref: "#/components/schemas/PatternMatching"
        earlyWarnings:
          description: Early warning signals
          items:
            $ref: "#/components/schemas/EarlyWarning"
          type: array
        similarCases:
          description: Similar historical cases
          items:
            $ref: "#/components/schemas/SimilarCase"
          type: array
        modelInfo:
          $ref: "#/components/schemas/ModelInfo"
    RiskFactor:
      description: Individual risk factor
      example:
        contribution: 14.9
        weight: 0.35
        description: description
        factor: historical_malicious_activity
      properties:
        factor:
          description: Factor name
          example: historical_malicious_activity
          type: string
        weight:
          description: Factor weight (0-1)
          example: 0.35
          format: double
          type: number
        contribution:
          description: Contribution to score
          example: 14.9
          format: double
          type: number
        description:
          description: Factor description
          type: string
    SimilarCase:
      description: Similar historical case
      example:
        similarity: 0.87
        caseId: caseId
        outcome: confirmed_malicious
      properties:
        similarity:
          description: Similarity score (0-1)
          example: 0.87
          format: double
          type: number
        outcome:
          description: Case outcome
          example: confirmed_malicious
          type: string
        caseId:
          description: Case ID
          type: string
    TrajectoryInfo:
      description: Risk trajectory analysis
      example:
        trend: increasing
        velocity: moderate
        stability: stable
      properties:
        trend:
          description: Trend direction
          example: increasing
          type: string
        velocity:
          description: Velocity of change
          example: moderate
          type: string
        stability:
          description: Trend stability
          example: stable
          type: string
    HistoryData:
      example:
        oldest_date: oldest_date
        records:
        - null
        - null
        total_records: 0
        newest_date: newest_date
        message: message
      properties:
        records:
          items:
            $ref: "#/components/schemas/JsonNode"
          type: array
        total_records:
          format: int32
          type: integer
        oldest_date:
          type: string
        newest_date:
          type: string
        message:
          type: string
    HistoryResponse:
      example:
        query:
          indicator: indicator
          history_type: history_type
          indicator_type: indicator_type
          response_time_ms: 0
          timestamp: timestamp
        history:
          oldest_date: oldest_date
          records:
          - null
          - null
          total_records: 0
          newest_date: newest_date
          message: message
      properties:
        query:
          $ref: "#/components/schemas/QueryInfo"
        history:
          $ref: "#/components/schemas/HistoryData"
    GraphLink:
      description: A link/edge connecting two nodes in the infrastructure graph
      example:
        weight: 1.0
        source: google.com
        type: hasNameserver
        properties:
          key: ""
        target: ns1.google.com
      properties:
        source:
          description: ID of the source node (where the relationship originates)
          example: google.com
          type: string
        target:
          description: ID of the target node (where the relationship points to)
          example: ns1.google.com
          type: string
        type:
          description: Type of relationship between the nodes
          enum:
          - resolvesTo
          - hasNameserver
          - hasMailHost
          - hasDomainParent
          - sameASN
          - sameNetwork
          - sameCertificate
          - sameRegistrant
          - linksTo
          - redirectsTo
          - contains
          example: hasNameserver
          type: string
        weight:
          description: Weight or strength of the relationship (for layout algorithms)
          example: 1.0
          format: double
          type: number
        properties:
          additionalProperties: {}
          description: Additional properties for link styling or filtering
    GraphNode:
      description: "A node in the infrastructure graph representing a domain, IP,\
        \ ASN, or other entity"
      example:
        id: google.com
        label: google.com
        type: DomainName
        properties:
          key: ""
      properties:
        id:
          description: "Unique identifier for the node (typically the domain name,\
            \ IP address, or ASN)"
          example: google.com
          type: string
        type:
          description: Type of infrastructure element this node represents
          enum:
          - DomainName
          - IpAddress
          - ASN
          - Nameserver
          - MailServer
          - Network
          - Certificate
          example: DomainName
          type: string
        label:
          description: Human-readable label for display (may differ from id)
          example: google.com
          type: string
        properties:
          additionalProperties: {}
          description: Additional properties for node styling or filtering
    GraphResponse:
      description: "Graph visualization data showing relationships between infrastructure\
        \ elements. Format is compatible with react-force-graph, vis.js, cytoscape.js,\
        \ and similar libraries."
      example:
        nodes:
        - id: google.com
          label: google.com
          type: DomainName
          properties:
            key: ""
        - id: google.com
          label: google.com
          type: DomainName
          properties:
            key: ""
        totalLinks: 230
        links:
        - weight: 1.0
          source: google.com
          type: hasNameserver
          properties:
            key: ""
          target: ns1.google.com
        - weight: 1.0
          source: google.com
          type: hasNameserver
          properties:
            key: ""
          target: ns1.google.com
        totalNodes: 150
      properties:
        nodes:
          description: List of nodes (vertices) in the graph. Each node represents
            an infrastructure element.
          items:
            $ref: "#/components/schemas/GraphNode"
          type: array
        links:
          description: List of links (edges) connecting nodes. Each link represents
            a relationship between elements.
          items:
            $ref: "#/components/schemas/GraphLink"
          type: array
        totalNodes:
          description: Total count of nodes before any limit was applied
          example: 150
          format: int32
          type: integer
        totalLinks:
          description: Total count of links before any limit was applied
          example: 230
          format: int32
          type: integer
    SubdomainInfo:
      description: Detailed information about a discovered subdomain
      example:
        technologies:
        - nginx
        - WordPress
        - CloudFlare
        first_seen: 2024-01-15T08:00:00Z
        last_seen: 2024-12-20T10:00:00Z
        risk_score: 15
        ip_addresses:
        - 192.0.2.1
        - 198.51.100.1
        subdomain: www.example.com
        record_type: A
        status: active
      properties:
        subdomain:
          description: The full subdomain name
          example: www.example.com
          type: string
        ip_addresses:
          description: IP addresses associated with the subdomain
          example:
          - 192.0.2.1
          - 198.51.100.1
          items:
            type: string
          type: array
        first_seen:
          description: First time this subdomain was observed
          example: 2024-01-15T08:00:00Z
          format: date-time
          type: string
        last_seen:
          description: Last time this subdomain was observed
          example: 2024-12-20T10:00:00Z
          format: date-time
          type: string
        record_type:
          description: Type of subdomain record
          enum:
          - A
          - AAAA
          - CNAME
          - MX
          - TXT
          - NS
          example: A
          type: string
        status:
          description: Current status of the subdomain
          enum:
          - active
          - inactive
          - parked
          example: active
          type: string
        technologies:
          description: Technology stack detected on this subdomain
          example:
          - nginx
          - WordPress
          - CloudFlare
          items:
            type: string
          type: array
        risk_score:
          description: Risk score for this subdomain (0-100)
          example: 15
          format: int32
          maximum: 100
          minimum: 0
          type: integer
      required:
      - subdomain
    SubdomainResponse:
      description: Response containing discovered subdomains and related metadata
      example:
        subdomains:
        - technologies:
          - nginx
          - WordPress
          - CloudFlare
          first_seen: 2024-01-15T08:00:00Z
          last_seen: 2024-12-20T10:00:00Z
          risk_score: 15
          ip_addresses:
          - 192.0.2.1
          - 198.51.100.1
          subdomain: www.example.com
          record_type: A
          status: active
        - technologies:
          - nginx
          - WordPress
          - CloudFlare
          first_seen: 2024-01-15T08:00:00Z
          last_seen: 2024-12-20T10:00:00Z
          risk_score: 15
          ip_addresses:
          - 192.0.2.1
          - 198.51.100.1
          subdomain: www.example.com
          record_type: A
          status: active
        sources:
        - passive_dns
        - certificate_transparency
        - web_crawling
        total_count: 42
        domain: example.com
        timestamp: 2024-12-20T10:15:30.123Z
      properties:
        domain:
          description: The root domain that was queried
          example: example.com
          type: string
        total_count:
          description: Total number of subdomains discovered
          example: 42
          format: int32
          type: integer
        subdomains:
          description: List of discovered subdomains
          items:
            $ref: "#/components/schemas/SubdomainInfo"
          type: array
        timestamp:
          description: Timestamp of when the data was retrieved
          example: 2024-12-20T10:15:30.123Z
          format: date-time
          type: string
        sources:
          description: Data sources used for subdomain discovery
          example:
          - passive_dns
          - certificate_transparency
          - web_crawling
          items:
            type: string
          type: array
      required:
      - domain
      - subdomains
      - timestamp
      - total_count
  securitySchemes:
    bearerAuth:
      bearerFormat: API Key
      description: "API key authentication. Obtain your API key from the [Whisper\
        \ Security Dashboard](https://dash.whisper.security). Include in requests\
        \ as: `Authorization: Bearer <your-api-key>`"
      scheme: bearer
      type: http

